import{_ as a,c as n,o as l,b as p}from"./chunks/framework.CMLuPXeo.js";const F=JSON.parse('{"title":"Redis","description":"","frontmatter":{},"headers":[{"level":2,"title":"引言","slug":"引言","link":"#引言","children":[]},{"level":2,"title":"核心特性","slug":"核心特性","link":"#核心特性","children":[{"level":3,"title":"内存存储与持久化","slug":"内存存储与持久化","link":"#内存存储与持久化","children":[]},{"level":3,"title":"丰富的数据结构","slug":"丰富的数据结构","link":"#丰富的数据结构","children":[]},{"level":3,"title":"单线程架构","slug":"单线程架构","link":"#单线程架构","children":[]}]},{"level":2,"title":"安装与配置","slug":"安装与配置","link":"#安装与配置","children":[{"level":3,"title":"安装 Redis 客户端库","slug":"安装-redis-客户端库","link":"#安装-redis-客户端库","children":[]},{"level":3,"title":"基础连接配置","slug":"基础连接配置","link":"#基础连接配置","children":[]}]},{"level":2,"title":"数据结构与操作","slug":"数据结构与操作","link":"#数据结构与操作","children":[{"level":3,"title":"String 操作","slug":"string-操作","link":"#string-操作","children":[]},{"level":3,"title":"Hash 操作","slug":"hash-操作","link":"#hash-操作","children":[]},{"level":3,"title":"List 操作","slug":"list-操作","link":"#list-操作","children":[]},{"level":3,"title":"Set 操作","slug":"set-操作","link":"#set-操作","children":[]},{"level":3,"title":"Sorted Set 操作","slug":"sorted-set-操作","link":"#sorted-set-操作","children":[]}]},{"level":2,"title":"高级特性","slug":"高级特性","link":"#高级特性","children":[{"level":3,"title":"事务支持","slug":"事务支持","link":"#事务支持","children":[]},{"level":3,"title":"发布订阅模式","slug":"发布订阅模式","link":"#发布订阅模式","children":[]},{"level":3,"title":"键空间通知","slug":"键空间通知","link":"#键空间通知","children":[]}]},{"level":2,"title":"实战应用场景","slug":"实战应用场景","link":"#实战应用场景","children":[{"level":3,"title":"会话存储","slug":"会话存储","link":"#会话存储","children":[]},{"level":3,"title":"缓存策略","slug":"缓存策略","link":"#缓存策略","children":[]},{"level":3,"title":"频率限制","slug":"频率限制","link":"#频率限制","children":[]}]},{"level":2,"title":"性能优化","slug":"性能优化","link":"#性能优化","children":[{"level":3,"title":"连接管理","slug":"连接管理","link":"#连接管理","children":[]},{"level":3,"title":"批量操作优化","slug":"批量操作优化","link":"#批量操作优化","children":[]}]},{"level":2,"title":"监控与调试","slug":"监控与调试","link":"#监控与调试","children":[{"level":3,"title":"性能监控","slug":"性能监控","link":"#性能监控","children":[]}]}],"relativePath":"full-stack/database/redis.md","filePath":"full-stack/database/redis.md"}'),o={name:"full-stack/database/redis.md"};function e(t,s,c,r,E,y){return l(),n("div",null,[...s[0]||(s[0]=[p(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /full-stack/database/redis.md for this page in Markdown format</div><h1 id="redis" tabindex="-1">Redis <a class="header-anchor" href="#redis" aria-label="Permalink to &quot;Redis&quot;">​</a></h1><h2 id="引言" tabindex="-1">引言 <a class="header-anchor" href="#引言" aria-label="Permalink to &quot;引言&quot;">​</a></h2><p>Redis (Remote Dictionary Server) 是一个开源的内存数据结构存储系统，常用作数据库、缓存和消息中间件。在 Node.js 应用中，Redis 凭借其卓越的性能和丰富的数据结构支持，成为提升应用性能的关键组件。</p><h2 id="核心特性" tabindex="-1">核心特性 <a class="header-anchor" href="#核心特性" aria-label="Permalink to &quot;核心特性&quot;">​</a></h2><h3 id="内存存储与持久化" tabindex="-1">内存存储与持久化 <a class="header-anchor" href="#内存存储与持久化" aria-label="Permalink to &quot;内存存储与持久化&quot;">​</a></h3><p>Redis 将所有数据存储在内存中，读写性能极高，同时提供两种持久化机制确保数据安全：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>内存存储 -&gt; RDB快照 -&gt; 磁盘</span></span>
<span class="line"><span>         -&gt; AOF日志 -&gt; 磁盘</span></span></code></pre></div><h3 id="丰富的数据结构" tabindex="-1">丰富的数据结构 <a class="header-anchor" href="#丰富的数据结构" aria-label="Permalink to &quot;丰富的数据结构&quot;">​</a></h3><p>Redis 支持多种数据结构，而不仅仅是简单的键值对：</p><ul><li><strong>String</strong>：字符串、整数、浮点数</li><li><strong>List</strong>：字符串列表，按插入顺序排序</li><li><strong>Set</strong>：无序的字符串集合，不重复</li><li><strong>Hash</strong>：字段-值对的映射表</li><li><strong>Sorted Set</strong>：有序的字符串集合，按分数排序</li><li><strong>Stream</strong>：日志数据结构，支持消费者组</li></ul><h3 id="单线程架构" tabindex="-1">单线程架构 <a class="header-anchor" href="#单线程架构" aria-label="Permalink to &quot;单线程架构&quot;">​</a></h3><p>Redis 采用单线程事件循环模型，避免了多线程的竞争条件，简化了数据一致性处理：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端请求 -&gt; 事件循环 -&gt; 命令执行 -&gt; 返回结果</span></span></code></pre></div><h2 id="安装与配置" tabindex="-1">安装与配置 <a class="header-anchor" href="#安装与配置" aria-label="Permalink to &quot;安装与配置&quot;">​</a></h2><h3 id="安装-redis-客户端库" tabindex="-1">安装 Redis 客户端库 <a class="header-anchor" href="#安装-redis-客户端库" aria-label="Permalink to &quot;安装 Redis 客户端库&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># 使用 npm 安装 ioredis（推荐）</span></span>
<span class="line"><span style="color:#B392F0;">npm</span><span style="color:#9ECBFF;"> install</span><span style="color:#9ECBFF;"> ioredis</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 或安装 node_redis（传统选择）</span></span>
<span class="line"><span style="color:#B392F0;">npm</span><span style="color:#9ECBFF;"> install</span><span style="color:#9ECBFF;"> redis</span></span></code></pre></div><h3 id="基础连接配置" tabindex="-1">基础连接配置 <a class="header-anchor" href="#基础连接配置" aria-label="Permalink to &quot;基础连接配置&quot;">​</a></h3><p><strong>使用 ioredis 连接示例：</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> Redis</span><span style="color:#F97583;"> =</span><span style="color:#B392F0;"> require</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;ioredis&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 基础连接</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> redis</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Redis</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  host: </span><span style="color:#9ECBFF;">&#39;127.0.0.1&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  port: </span><span style="color:#79B8FF;">6379</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  password: </span><span style="color:#9ECBFF;">&#39;your_password&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">// 可选</span></span>
<span class="line"><span style="color:#E1E4E8;">  db: </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">// 数据库编号，0-15</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 连接事件监听</span></span>
<span class="line"><span style="color:#E1E4E8;">redis.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;connect&#39;</span><span style="color:#E1E4E8;">, () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Redis 连接成功&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">redis.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;error&#39;</span><span style="color:#E1E4E8;">, (</span><span style="color:#FFAB70;">err</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Redis 连接错误:&#39;</span><span style="color:#E1E4E8;">, err);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre></div><p><strong>连接池配置：</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> redis</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Redis</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  host: </span><span style="color:#9ECBFF;">&#39;127.0.0.1&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  port: </span><span style="color:#79B8FF;">6379</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  retryDelayOnFailover: </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  maxRetriesPerRequest: </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  lazyConnect: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">// 延迟连接</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre></div><h2 id="数据结构与操作" tabindex="-1">数据结构与操作 <a class="header-anchor" href="#数据结构与操作" aria-label="Permalink to &quot;数据结构与操作&quot;">​</a></h2><h3 id="string-操作" tabindex="-1">String 操作 <a class="header-anchor" href="#string-操作" aria-label="Permalink to &quot;String 操作&quot;">​</a></h3><p>String 是 Redis 最基本的数据类型，可以存储字符串、整数或浮点数。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 设置和获取字符串</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;user:1000:name&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;张三&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> userName</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;user:1000:name&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(userName); </span><span style="color:#6A737D;">// &quot;张三&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 设置带过期时间的键</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;session:token123&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;user_data&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;EX&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">3600</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 1小时后过期</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 递增递减操作</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;counter&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">incr</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;counter&#39;</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 11</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">decrby</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;counter&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 批量操作</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">mset</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;key1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;value1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;key2&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;value2&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;key3&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;value3&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> values</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">mget</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;key1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;key2&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;key3&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><h3 id="hash-操作" tabindex="-1">Hash 操作 <a class="header-anchor" href="#hash-操作" aria-label="Permalink to &quot;Hash 操作&quot;">​</a></h3><p>Hash 适合存储对象，可以单独操作字段而不需要序列化整个对象。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 存储用户对象</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">hset</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;user:1000&#39;</span><span style="color:#E1E4E8;">, {</span></span>
<span class="line"><span style="color:#E1E4E8;">  name: </span><span style="color:#9ECBFF;">&#39;李四&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  email: </span><span style="color:#9ECBFF;">&#39;lisi@example.com&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  age: </span><span style="color:#9ECBFF;">&#39;30&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 获取单个字段</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> userName</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">hget</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;user:1000&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;name&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 获取所有字段</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> userData</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">hgetall</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;user:1000&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 更新特定字段</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">hincrby</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;user:1000&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;age&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 检查字段是否存在</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> hasEmail</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">hexists</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;user:1000&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;email&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><h3 id="list-操作" tabindex="-1">List 操作 <a class="header-anchor" href="#list-操作" aria-label="Permalink to &quot;List 操作&quot;">​</a></h3><p>List 是基于链表实现的字符串列表，支持从两端添加或移除元素。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 消息队列实现</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">lpush</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;message:queue&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;message1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;message2&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;message3&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">rpush</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;message:queue&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;message4&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 消费消息</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> message</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">rpop</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;message:queue&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 获取列表范围</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> messages</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">lrange</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;message:queue&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 阻塞式弹出（适合任务队列）</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> task</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">brpop</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;task:queue&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">30</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 阻塞30秒</span></span></code></pre></div><h3 id="set-操作" tabindex="-1">Set 操作 <a class="header-anchor" href="#set-操作" aria-label="Permalink to &quot;Set 操作&quot;">​</a></h3><p>Set 是无序的字符串集合，支持交集、并集、差集等集合运算。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 添加元素</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">sadd</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;tags&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;javascript&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;nodejs&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;redis&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;database&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 检查成员是否存在</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> hasRedis</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">sismember</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;tags&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;redis&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 获取所有成员</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> allTags</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">smembers</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;tags&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 集合运算</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">sadd</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;frontend&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;javascript&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;html&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;css&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">sadd</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;backend&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;javascript&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;nodejs&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;python&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> common</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">sinter</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;frontend&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;backend&#39;</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 交集</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> all</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">sunion</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;frontend&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;backend&#39;</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 并集</span></span></code></pre></div><h3 id="sorted-set-操作" tabindex="-1">Sorted Set 操作 <a class="header-anchor" href="#sorted-set-操作" aria-label="Permalink to &quot;Sorted Set 操作&quot;">​</a></h3><p>Sorted Set 是有序集合，每个成员都关联一个分数，用于排序。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 排行榜实现</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">zadd</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;leaderboard&#39;</span><span style="color:#E1E4E8;">, </span></span>
<span class="line"><span style="color:#79B8FF;">  2840</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;player1&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">  3500</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;player2&#39;</span><span style="color:#E1E4E8;">, </span></span>
<span class="line"><span style="color:#79B8FF;">  1920</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;player3&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 获取前3名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> topPlayers</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">zrevrange</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;leaderboard&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;WITHSCORES&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 更新分数</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">zincrby</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;leaderboard&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;player1&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 获取排名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> rank</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">zrevrank</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;leaderboard&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;player1&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> score</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">zscore</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;leaderboard&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;player1&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><h2 id="高级特性" tabindex="-1">高级特性 <a class="header-anchor" href="#高级特性" aria-label="Permalink to &quot;高级特性&quot;">​</a></h2><h3 id="事务支持" tabindex="-1">事务支持 <a class="header-anchor" href="#事务支持" aria-label="Permalink to &quot;事务支持&quot;">​</a></h3><p>Redis 事务可以批量执行命令，确保原子性。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// MULTI/EXEC 事务</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> multi</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">multi</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">multi.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;key1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;value1&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">multi.</span><span style="color:#B392F0;">incr</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;counter&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">multi.</span><span style="color:#B392F0;">expire</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;key1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">60</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> results</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> multi.</span><span style="color:#B392F0;">exec</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 使用 pipeline 提升性能</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> pipeline</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">pipeline</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#79B8FF;"> 0</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#79B8FF;"> 100</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  pipeline.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`key:\${</span><span style="color:#E1E4E8;">i</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">\`value:\${</span><span style="color:#E1E4E8;">i</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> pipelineResults</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> pipeline.</span><span style="color:#B392F0;">exec</span><span style="color:#E1E4E8;">();</span></span></code></pre></div><h3 id="发布订阅模式" tabindex="-1">发布订阅模式 <a class="header-anchor" href="#发布订阅模式" aria-label="Permalink to &quot;发布订阅模式&quot;">​</a></h3><p>Redis 支持消息的发布订阅，适用于实时通信场景。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 订阅者</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> subscriber</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Redis</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> subscriber.</span><span style="color:#B392F0;">subscribe</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;news&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;sports&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">subscriber.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;message&#39;</span><span style="color:#E1E4E8;">, (</span><span style="color:#FFAB70;">channel</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">message</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`收到频道 \${</span><span style="color:#E1E4E8;">channel</span><span style="color:#9ECBFF;">} 的消息: \${</span><span style="color:#E1E4E8;">message</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 发布者</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> publisher</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Redis</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> publisher.</span><span style="color:#B392F0;">publish</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;news&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;最新消息！&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> publisher.</span><span style="color:#B392F0;">publish</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;sports&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;比赛结果公布&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><h3 id="键空间通知" tabindex="-1">键空间通知 <a class="header-anchor" href="#键空间通知" aria-label="Permalink to &quot;键空间通知&quot;">​</a></h3><p>监控键的变更事件，适用于缓存失效、数据同步等场景。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 配置键空间通知</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">config</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;SET&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;notify-keyspace-events&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;KEA&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 订阅过期事件</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> subscriber</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Redis</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> subscriber.</span><span style="color:#B392F0;">psubscribe</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;__keyevent@0__:expired&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">subscriber.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;pmessage&#39;</span><span style="color:#E1E4E8;">, (</span><span style="color:#FFAB70;">pattern</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">channel</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">message</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`键过期: \${</span><span style="color:#E1E4E8;">message</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">  // 处理缓存失效逻辑</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre></div><h2 id="实战应用场景" tabindex="-1">实战应用场景 <a class="header-anchor" href="#实战应用场景" aria-label="Permalink to &quot;实战应用场景&quot;">​</a></h2><h3 id="会话存储" tabindex="-1">会话存储 <a class="header-anchor" href="#会话存储" aria-label="Permalink to &quot;会话存储&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#B392F0;"> SessionStore</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">  constructor</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">redisClient</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#79B8FF;">    this</span><span style="color:#E1E4E8;">.redis </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> redisClient;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  async</span><span style="color:#B392F0;"> get</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">sessionId</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> sessionData</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`session:\${</span><span style="color:#E1E4E8;">sessionId</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#E1E4E8;"> sessionData </span><span style="color:#F97583;">?</span><span style="color:#79B8FF;"> JSON</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">parse</span><span style="color:#E1E4E8;">(sessionData) </span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> null</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  async</span><span style="color:#B392F0;"> set</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">sessionId</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">data</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">ttl</span><span style="color:#F97583;"> =</span><span style="color:#79B8FF;"> 3600</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis.</span><span style="color:#B392F0;">setex</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#9ECBFF;">      \`session:\${</span><span style="color:#E1E4E8;">sessionId</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      ttl,</span></span>
<span class="line"><span style="color:#79B8FF;">      JSON</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">stringify</span><span style="color:#E1E4E8;">(data)</span></span>
<span class="line"><span style="color:#E1E4E8;">    );</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  async</span><span style="color:#B392F0;"> destroy</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">sessionId</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis.</span><span style="color:#B392F0;">del</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`session:\${</span><span style="color:#E1E4E8;">sessionId</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h3 id="缓存策略" tabindex="-1">缓存策略 <a class="header-anchor" href="#缓存策略" aria-label="Permalink to &quot;缓存策略&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#B392F0;"> CacheService</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">  constructor</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">redisClient</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#79B8FF;">    this</span><span style="color:#E1E4E8;">.redis </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> redisClient;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  async</span><span style="color:#B392F0;"> cacheWithFallback</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">key</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">ttl</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">fallbackFunc</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#6A737D;">    // 尝试从缓存获取</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> cached</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(key);</span></span>
<span class="line"><span style="color:#F97583;">    if</span><span style="color:#E1E4E8;"> (cached) {</span></span>
<span class="line"><span style="color:#F97583;">      return</span><span style="color:#79B8FF;"> JSON</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">parse</span><span style="color:#E1E4E8;">(cached);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">    // 缓存未命中，执行回退函数</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> data</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#B392F0;"> fallbackFunc</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#6A737D;">    // 设置缓存</span></span>
<span class="line"><span style="color:#F97583;">    await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis.</span><span style="color:#B392F0;">setex</span><span style="color:#E1E4E8;">(key, ttl, </span><span style="color:#79B8FF;">JSON</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">stringify</span><span style="color:#E1E4E8;">(data));</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#E1E4E8;"> data;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  async</span><span style="color:#B392F0;"> invalidatePattern</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">pattern</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> keys</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis.</span><span style="color:#B392F0;">keys</span><span style="color:#E1E4E8;">(pattern);</span></span>
<span class="line"><span style="color:#F97583;">    if</span><span style="color:#E1E4E8;"> (keys.</span><span style="color:#79B8FF;">length</span><span style="color:#F97583;"> &gt;</span><span style="color:#79B8FF;"> 0</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">      await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis.</span><span style="color:#B392F0;">del</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">...</span><span style="color:#E1E4E8;">keys);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h3 id="频率限制" tabindex="-1">频率限制 <a class="header-anchor" href="#频率限制" aria-label="Permalink to &quot;频率限制&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#B392F0;"> RateLimiter</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">  constructor</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">redisClient</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">maxRequests</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">windowMs</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#79B8FF;">    this</span><span style="color:#E1E4E8;">.redis </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> redisClient;</span></span>
<span class="line"><span style="color:#79B8FF;">    this</span><span style="color:#E1E4E8;">.maxRequests </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> maxRequests;</span></span>
<span class="line"><span style="color:#79B8FF;">    this</span><span style="color:#E1E4E8;">.windowMs </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> windowMs;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  async</span><span style="color:#B392F0;"> checkLimit</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">identifier</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> key</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> \`rate_limit:\${</span><span style="color:#E1E4E8;">identifier</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> now</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> Date.</span><span style="color:#B392F0;">now</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> pipeline</span><span style="color:#F97583;"> =</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis.</span><span style="color:#B392F0;">pipeline</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    pipeline.</span><span style="color:#B392F0;">zremrangebyscore</span><span style="color:#E1E4E8;">(key, </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, now </span><span style="color:#F97583;">-</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.windowMs);</span></span>
<span class="line"><span style="color:#E1E4E8;">    pipeline.</span><span style="color:#B392F0;">zadd</span><span style="color:#E1E4E8;">(key, now, now.</span><span style="color:#B392F0;">toString</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">    pipeline.</span><span style="color:#B392F0;">zcard</span><span style="color:#E1E4E8;">(key);</span></span>
<span class="line"><span style="color:#E1E4E8;">    pipeline.</span><span style="color:#B392F0;">expire</span><span style="color:#E1E4E8;">(key, Math.</span><span style="color:#B392F0;">ceil</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.windowMs </span><span style="color:#F97583;">/</span><span style="color:#79B8FF;"> 1000</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> results</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> pipeline.</span><span style="color:#B392F0;">exec</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> requestCount</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> results[</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">][</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#E1E4E8;"> requestCount </span><span style="color:#F97583;">&lt;=</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.maxRequests;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h2 id="性能优化" tabindex="-1">性能优化 <a class="header-anchor" href="#性能优化" aria-label="Permalink to &quot;性能优化&quot;">​</a></h2><h3 id="连接管理" tabindex="-1">连接管理 <a class="header-anchor" href="#连接管理" aria-label="Permalink to &quot;连接管理&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 连接池配置</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> redisCluster</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#E1E4E8;"> Redis.</span><span style="color:#B392F0;">Cluster</span><span style="color:#E1E4E8;">([</span></span>
<span class="line"><span style="color:#E1E4E8;">  { host: </span><span style="color:#9ECBFF;">&#39;127.0.0.1&#39;</span><span style="color:#E1E4E8;">, port: </span><span style="color:#79B8FF;">6379</span><span style="color:#E1E4E8;"> },</span></span>
<span class="line"><span style="color:#E1E4E8;">  { host: </span><span style="color:#9ECBFF;">&#39;127.0.0.1&#39;</span><span style="color:#E1E4E8;">, port: </span><span style="color:#79B8FF;">6380</span><span style="color:#E1E4E8;"> }</span></span>
<span class="line"><span style="color:#E1E4E8;">], {</span></span>
<span class="line"><span style="color:#E1E4E8;">  scaleReads: </span><span style="color:#9ECBFF;">&#39;slave&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">// 将读请求分发到从节点</span></span>
<span class="line"><span style="color:#E1E4E8;">  redisOptions: {</span></span>
<span class="line"><span style="color:#E1E4E8;">    password: </span><span style="color:#9ECBFF;">&#39;your_password&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 健康检查</span></span>
<span class="line"><span style="color:#B392F0;">setInterval</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  redis.</span><span style="color:#B392F0;">ping</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">catch</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">err</span><span style="color:#F97583;"> =&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    console.</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Redis 连接异常:&#39;</span><span style="color:#E1E4E8;">, err);</span></span>
<span class="line"><span style="color:#E1E4E8;">  });</span></span>
<span class="line"><span style="color:#E1E4E8;">}, </span><span style="color:#79B8FF;">30000</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><h3 id="批量操作优化" tabindex="-1">批量操作优化 <a class="header-anchor" href="#批量操作优化" aria-label="Permalink to &quot;批量操作优化&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 使用 pipeline 批量操作</span></span>
<span class="line"><span style="color:#F97583;">async</span><span style="color:#F97583;"> function</span><span style="color:#B392F0;"> batchInsertUsers</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">users</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">  const</span><span style="color:#79B8FF;"> pipeline</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">pipeline</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#E1E4E8;">  users.</span><span style="color:#B392F0;">forEach</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">user</span><span style="color:#F97583;"> =&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    pipeline.</span><span style="color:#B392F0;">hset</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`user:\${</span><span style="color:#E1E4E8;">user</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">id</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">, user);</span></span>
<span class="line"><span style="color:#E1E4E8;">    pipeline.</span><span style="color:#B392F0;">expire</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`user:\${</span><span style="color:#E1E4E8;">user</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">id</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">3600</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  });</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#F97583;">  await</span><span style="color:#E1E4E8;"> pipeline.</span><span style="color:#B392F0;">exec</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 使用 Lua 脚本保证原子性</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> incrementScript</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> \`</span></span>
<span class="line"><span style="color:#9ECBFF;">  local current = redis.call(&#39;get&#39;, KEYS[1])</span></span>
<span class="line"><span style="color:#9ECBFF;">  if current then</span></span>
<span class="line"><span style="color:#9ECBFF;">    redis.call(&#39;set&#39;, KEYS[1], tonumber(current) + tonumber(ARGV[1]))</span></span>
<span class="line"><span style="color:#9ECBFF;">  else</span></span>
<span class="line"><span style="color:#9ECBFF;">    redis.call(&#39;set&#39;, KEYS[1], ARGV[1])</span></span>
<span class="line"><span style="color:#9ECBFF;">  end</span></span>
<span class="line"><span style="color:#9ECBFF;">\`</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> redis.</span><span style="color:#B392F0;">eval</span><span style="color:#E1E4E8;">(incrementScript, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;counter&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><h2 id="监控与调试" tabindex="-1">监控与调试 <a class="header-anchor" href="#监控与调试" aria-label="Permalink to &quot;监控与调试&quot;">​</a></h2><h3 id="性能监控" tabindex="-1">性能监控 <a class="header-anchor" href="#性能监控" aria-label="Permalink to &quot;性能监控&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#B392F0;"> RedisMonitor</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">  constructor</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">redisClient</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#79B8FF;">    this</span><span style="color:#E1E4E8;">.redis </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> redisClient;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  async</span><span style="color:#B392F0;"> getStats</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> info</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis.</span><span style="color:#B392F0;">info</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> slowLog</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis.</span><span style="color:#B392F0;">slowlog</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;get&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      connected_clients: info.connected_clients,</span></span>
<span class="line"><span style="color:#E1E4E8;">      used_memory: info.used_memory_human,</span></span>
<span class="line"><span style="color:#E1E4E8;">      hits: info.keyspace_hits,</span></span>
<span class="line"><span style="color:#E1E4E8;">      misses: info.keyspace_misses,</span></span>
<span class="line"><span style="color:#E1E4E8;">      slow_commands: slowLog</span></span>
<span class="line"><span style="color:#E1E4E8;">    };</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  async</span><span style="color:#B392F0;"> trackCommand</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">cmd</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">...</span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> start</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> Date.</span><span style="color:#B392F0;">now</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">    try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">      const</span><span style="color:#79B8FF;"> result</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.redis[cmd](</span><span style="color:#F97583;">...</span><span style="color:#E1E4E8;">args);</span></span>
<span class="line"><span style="color:#F97583;">      const</span><span style="color:#79B8FF;"> duration</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> Date.</span><span style="color:#B392F0;">now</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> start;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span></span>
<span class="line"><span style="color:#F97583;">      if</span><span style="color:#E1E4E8;"> (duration </span><span style="color:#F97583;">&gt;</span><span style="color:#79B8FF;"> 100</span><span style="color:#E1E4E8;">) { </span><span style="color:#6A737D;">// 记录慢查询</span></span>
<span class="line"><span style="color:#E1E4E8;">        console.</span><span style="color:#B392F0;">warn</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Slow Redis command: \${</span><span style="color:#E1E4E8;">cmd</span><span style="color:#9ECBFF;">}, duration: \${</span><span style="color:#E1E4E8;">duration</span><span style="color:#9ECBFF;">}ms\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span></span>
<span class="line"><span style="color:#F97583;">      return</span><span style="color:#E1E4E8;"> result;</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (error) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      console.</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Redis command failed: \${</span><span style="color:#E1E4E8;">cmd</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">, error);</span></span>
<span class="line"><span style="color:#F97583;">      throw</span><span style="color:#E1E4E8;"> error;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div>`,63)])])}const d=a(o,[["render",e]]);export{F as __pageData,d as default};
