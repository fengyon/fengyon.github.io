import{_ as s,c as n,o as l,b as e}from"./chunks/framework.CMLuPXeo.js";const u=JSON.parse('{"title":"UDP","description":"","frontmatter":{},"headers":[{"level":2,"title":"介绍","slug":"介绍","link":"#介绍","children":[]},{"level":2,"title":"历史","slug":"历史","link":"#历史","children":[]},{"level":2,"title":"协议概述","slug":"协议概述","link":"#协议概述","children":[]},{"level":2,"title":"核心特点","slug":"核心特点","link":"#核心特点","children":[{"level":3,"title":"无连接通信","slug":"无连接通信","link":"#无连接通信","children":[]},{"level":3,"title":"不可靠传输","slug":"不可靠传输","link":"#不可靠传输","children":[]},{"level":3,"title":"无拥塞控制","slug":"无拥塞控制","link":"#无拥塞控制","children":[]},{"level":3,"title":"消息边界保留","slug":"消息边界保留","link":"#消息边界保留","children":[]},{"level":3,"title":"轻量级头部","slug":"轻量级头部","link":"#轻量级头部","children":[]},{"level":3,"title":"支持广播和多播","slug":"支持广播和多播","link":"#支持广播和多播","children":[]}]},{"level":2,"title":"工作原理","slug":"工作原理","link":"#工作原理","children":[{"level":3,"title":"数据报封装","slug":"数据报封装","link":"#数据报封装","children":[]},{"level":3,"title":"端口机制","slug":"端口机制","link":"#端口机制","children":[]},{"level":3,"title":"校验和计算","slug":"校验和计算","link":"#校验和计算","children":[]}]},{"level":2,"title":"头部格式","slug":"头部格式","link":"#头部格式","children":[]},{"level":2,"title":"适用场景","slug":"适用场景","link":"#适用场景","children":[{"level":3,"title":"实时多媒体传输","slug":"实时多媒体传输","link":"#实时多媒体传输","children":[]},{"level":3,"title":"查询-响应协议","slug":"查询-响应协议","link":"#查询-响应协议","children":[]},{"level":3,"title":"在线游戏","slug":"在线游戏","link":"#在线游戏","children":[]},{"level":3,"title":"流媒体广播","slug":"流媒体广播","link":"#流媒体广播","children":[]},{"level":3,"title":"网络监控","slug":"网络监控","link":"#网络监控","children":[]}]},{"level":2,"title":"与 TCP 对比","slug":"与-tcp-对比","link":"#与-tcp-对比","children":[{"level":3,"title":"特性对比","slug":"特性对比","link":"#特性对比","children":[]},{"level":3,"title":"选择指南","slug":"选择指南","link":"#选择指南","children":[]}]},{"level":2,"title":"应用层可靠性","slug":"应用层可靠性","link":"#应用层可靠性","children":[{"level":3,"title":"确认与重传","slug":"确认与重传","link":"#确认与重传","children":[]},{"level":3,"title":"前向纠错","slug":"前向纠错","link":"#前向纠错","children":[]},{"level":3,"title":"质量反馈","slug":"质量反馈","link":"#质量反馈","children":[]}]},{"level":2,"title":"安全考虑","slug":"安全考虑","link":"#安全考虑","children":[{"level":3,"title":"固有漏洞","slug":"固有漏洞","link":"#固有漏洞","children":[]},{"level":3,"title":"防护措施","slug":"防护措施","link":"#防护措施","children":[]}]}],"relativePath":"full-stack/network/udp.md","filePath":"full-stack/network/udp.md"}'),p={name:"full-stack/network/udp.md"};function i(t,a,c,o,d,r){return l(),n("div",null,[...a[0]||(a[0]=[e(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /full-stack/network/udp.md for this page in Markdown format</div><h1 id="udp" tabindex="-1">UDP <a class="header-anchor" href="#udp" aria-label="Permalink to &quot;UDP&quot;">​</a></h1><h2 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h2><p>UDP (User Datagram Protocol) 是一种无连接的传输层协议，提供简单的、不可靠的数据报服务。与 TCP 的可靠传输不同，UDP 专注于最小化的协议机制，为应用程序提供低开销、低延迟的通信能力。UDP 不保证数据交付、不保证顺序、不提供拥塞控制，将可靠性责任完全交给应用层。</p><h2 id="历史" tabindex="-1">历史 <a class="header-anchor" href="#历史" aria-label="Permalink to &quot;历史&quot;">​</a></h2><p>UDP 源于 1980 年的 RFC 768，由 David P。Reed 设计。作为 TCP/IP 协议套件的重要组成部分，UDP 与 TCP 形成互补。早期主要用于 DNS 查询、路由信息协议等简单应用。随着实时多媒体应用的发展，UDP 的重要性日益凸显。在视频会议、在线游戏、流媒体等场景中，UDP 的低延迟特性使其成为不可替代的选择。</p><h2 id="协议概述" tabindex="-1">协议概述 <a class="header-anchor" href="#协议概述" aria-label="Permalink to &quot;协议概述&quot;">​</a></h2><p>UDP 位于 TCP/IP 模型的传输层，直接基于 IP 协议工作：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>应用层数据</span></span>
<span class="line"><span>↓</span></span>
<span class="line"><span>UDP头部封装</span></span>
<span class="line"><span>↓</span></span>
<span class="line"><span>IP数据包</span></span>
<span class="line"><span>↓</span></span>
<span class="line"><span>网络传输</span></span></code></pre></div><p>UDP 在协议栈中的位置与 TCP 平行，为应用提供另一种传输选择。</p><h2 id="核心特点" tabindex="-1">核心特点 <a class="header-anchor" href="#核心特点" aria-label="Permalink to &quot;核心特点&quot;">​</a></h2><h3 id="无连接通信" tabindex="-1">无连接通信 <a class="header-anchor" href="#无连接通信" aria-label="Permalink to &quot;无连接通信&quot;">​</a></h3><p>UDP 不需要预先建立连接，每个数据报独立处理。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端: [数据报1] -&gt; 服务器</span></span>
<span class="line"><span>客户端: [数据报2] -&gt; 服务器</span></span>
<span class="line"><span>客户端: [数据报3] -&gt; 服务器</span></span></code></pre></div><p>与 TCP 对比：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>TCP: 握手 -&gt; 数据传输 -&gt; 挥手</span></span>
<span class="line"><span>UDP: 直接发送数据报</span></span></code></pre></div><p>优势：减少延迟、降低开销。</p><h3 id="不可靠传输" tabindex="-1">不可靠传输 <a class="header-anchor" href="#不可靠传输" aria-label="Permalink to &quot;不可靠传输&quot;">​</a></h3><p>UDP 不保证数据交付，数据报可能丢失、重复、乱序。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>发送: 包1, 包2, 包3, 包4</span></span>
<span class="line"><span>接收: 包1, 包3, 包4 (包2丢失)</span></span></code></pre></div><p>应用层需要自行处理丢包和乱序问题。</p><h3 id="无拥塞控制" tabindex="-1">无拥塞控制 <a class="header-anchor" href="#无拥塞控制" aria-label="Permalink to &quot;无拥塞控制&quot;">​</a></h3><p>UDP 不包含拥塞避免机制，可能加剧网络拥塞。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>UDP流: 持续高速发送 -&gt; 可能造成网络拥堵</span></span>
<span class="line"><span>TCP流: 根据拥塞窗口调整速率 -&gt; 相对友好</span></span></code></pre></div><p>需要应用层实现适当的速率控制。</p><h3 id="消息边界保留" tabindex="-1">消息边界保留 <a class="header-anchor" href="#消息边界保留" aria-label="Permalink to &quot;消息边界保留&quot;">​</a></h3><p>UDP 保留应用层消息边界，每个数据报独立交付。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>发送: &quot;Hello&quot; + &quot;World&quot;</span></span>
<span class="line"><span>接收: &quot;Hello&quot;, &quot;World&quot; (两个独立数据报)</span></span></code></pre></div><p>与 TCP 的字节流对比：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>TCP发送: &quot;Hello&quot; + &quot;World&quot;</span></span>
<span class="line"><span>TCP接收: &quot;HelloWorld&quot; (可能合并)</span></span></code></pre></div><h3 id="轻量级头部" tabindex="-1">轻量级头部 <a class="header-anchor" href="#轻量级头部" aria-label="Permalink to &quot;轻量级头部&quot;">​</a></h3><p>UDP 头部固定 8 字节，远小于 TCP 的 20-60 字节头部。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>UDP头部: [源端口|目的端口|长度|校验和]</span></span>
<span class="line"><span>TCP头部: [更多字段包括序列号、确认号、窗口等]</span></span></code></pre></div><p>减少协议开销，提高传输效率。</p><h3 id="支持广播和多播" tabindex="-1">支持广播和多播 <a class="header-anchor" href="#支持广播和多播" aria-label="Permalink to &quot;支持广播和多播&quot;">​</a></h3><p>UDP 支持一对一、一对多、多对多通信模式。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>单播:   客户端A -&gt; 服务器</span></span>
<span class="line"><span>广播:   服务器 -&gt; 所有客户端</span></span>
<span class="line"><span>多播:   服务器 -&gt; 组成员</span></span></code></pre></div><p>适用于群组通信场景。</p><h2 id="工作原理" tabindex="-1">工作原理 <a class="header-anchor" href="#工作原理" aria-label="Permalink to &quot;工作原理&quot;">​</a></h2><h3 id="数据报封装" tabindex="-1">数据报封装 <a class="header-anchor" href="#数据报封装" aria-label="Permalink to &quot;数据报封装&quot;">​</a></h3><p>应用数据添加 UDP 头部形成 UDP 数据报，再封装为 IP 数据包。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>[应用数据]</span></span>
<span class="line"><span>↓ 添加UDP头部</span></span>
<span class="line"><span>[UDP头][应用数据] (UDP数据报)</span></span>
<span class="line"><span>↓ 添加IP头部</span></span>
<span class="line"><span>[IP头][UDP头][应用数据] (IP数据包)</span></span></code></pre></div><h3 id="端口机制" tabindex="-1">端口机制 <a class="header-anchor" href="#端口机制" aria-label="Permalink to &quot;端口机制&quot;">​</a></h3><p>UDP 使用端口号标识应用进程，实现多路复用。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端端口1234 -&gt; 服务器端口53 (DNS)</span></span>
<span class="line"><span>客户端端口1235 -&gt; 服务器端口80 (HTTP后端)</span></span></code></pre></div><p>同一 IP 地址可运行多个 UDP 服务。</p><h3 id="校验和计算" tabindex="-1">校验和计算 <a class="header-anchor" href="#校验和计算" aria-label="Permalink to &quot;校验和计算&quot;">​</a></h3><p>UDP 提供可选的校验和机制，检测数据 corruption。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>计算: 伪头部 + UDP头部 + 数据 -&gt; 16位反码求和</span></span>
<span class="line"><span>验证: 接收方重新计算，不匹配则静默丢弃</span></span></code></pre></div><h2 id="头部格式" tabindex="-1">头部格式 <a class="header-anchor" href="#头部格式" aria-label="Permalink to &quot;头部格式&quot;">​</a></h2><p>UDP 头部简洁明了，包含四个 16 位字段：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span> 0       16       32       48</span></span>
<span class="line"><span>+--------+--------+--------+--------+</span></span>
<span class="line"><span>|   源端口   |     目的端口    |</span></span>
<span class="line"><span>+--------+--------+--------+--------+</span></span>
<span class="line"><span>|     长度     |     校验和     |</span></span>
<span class="line"><span>+--------+--------+--------+--------+</span></span>
<span class="line"><span>|            应用数据              |</span></span>
<span class="line"><span>+----------------------------------+</span></span></code></pre></div><p>字段说明：</p><ul><li>源端口：发送方端口号 (可选，0 表示无)</li><li>目的端口：接收方端口号</li><li>长度：UDP 头部和数据的总长度 (字节)</li><li>校验和：头部和数据的错误检测码</li></ul><h2 id="适用场景" tabindex="-1">适用场景 <a class="header-anchor" href="#适用场景" aria-label="Permalink to &quot;适用场景&quot;">​</a></h2><h3 id="实时多媒体传输" tabindex="-1">实时多媒体传输 <a class="header-anchor" href="#实时多媒体传输" aria-label="Permalink to &quot;实时多媒体传输&quot;">​</a></h3><p>视频会议、VoIP 等应用能容忍少量丢包，但不能接受 TCP 重传延迟。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>视频帧1 [丢失] 视频帧2 [到达] 视频帧3 [到达]</span></span>
<span class="line"><span>处理: 跳过帧1，继续播放帧2、帧3</span></span></code></pre></div><h3 id="查询-响应协议" tabindex="-1">查询-响应协议 <a class="header-anchor" href="#查询-响应协议" aria-label="Permalink to &quot;查询-响应协议&quot;">​</a></h3><p>DNS、DHCP 等简单查询，单个请求响应对。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端: [DNS查询] -&gt; 服务器</span></span>
<span class="line"><span>客户端: [DNS响应] &lt;- 服务器</span></span>
<span class="line"><span>超时则重试</span></span></code></pre></div><h3 id="在线游戏" tabindex="-1">在线游戏 <a class="header-anchor" href="#在线游戏" aria-label="Permalink to &quot;在线游戏&quot;">​</a></h3><p>游戏状态更新需要低延迟，偶尔丢包可接受。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>玩家位置更新: 高频发送，最新状态覆盖旧状态</span></span>
<span class="line"><span>丢包影响: 短暂卡顿，但很快恢复</span></span></code></pre></div><h3 id="流媒体广播" tabindex="-1">流媒体广播 <a class="header-anchor" href="#流媒体广播" aria-label="Permalink to &quot;流媒体广播&quot;">​</a></h3><p>音视频流媒体，消费者能容忍少量数据丢失。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>音频流: [包1][包2][丢失][包4]...</span></span>
<span class="line"><span>处理: 使用插值掩盖丢失数据</span></span></code></pre></div><h3 id="网络监控" tabindex="-1">网络监控 <a class="header-anchor" href="#网络监控" aria-label="Permalink to &quot;网络监控&quot;">​</a></h3><p>大量设备状态报告，个别丢失不影响整体统计。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>设备1: [状态] -&gt; 监控服务器</span></span>
<span class="line"><span>设备2: [状态] [丢失]</span></span>
<span class="line"><span>设备3: [状态] -&gt; 监控服务器</span></span></code></pre></div><h2 id="与-tcp-对比" tabindex="-1">与 TCP 对比 <a class="header-anchor" href="#与-tcp-对比" aria-label="Permalink to &quot;与 TCP 对比&quot;">​</a></h2><h3 id="特性对比" tabindex="-1">特性对比 <a class="header-anchor" href="#特性对比" aria-label="Permalink to &quot;特性对比&quot;">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>可靠性:    TCP - 有, UDP - 无</span></span>
<span class="line"><span>连接性:    TCP - 面向连接, UDP - 无连接</span></span>
<span class="line"><span>有序性:    TCP - 保证顺序, UDP - 不保证</span></span>
<span class="line"><span>速度:      TCP - 较慢, UDP - 较快</span></span>
<span class="line"><span>开销:      TCP - 较高, UDP - 较低</span></span>
<span class="line"><span>控制:      TCP - 拥塞控制, UDP - 无控制</span></span></code></pre></div><h3 id="选择指南" tabindex="-1">选择指南 <a class="header-anchor" href="#选择指南" aria-label="Permalink to &quot;选择指南&quot;">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>选择TCP当: 需要可靠交付、数据完整性关键、能容忍延迟</span></span>
<span class="line"><span>选择UDP当: 延迟敏感、能容忍丢包、需要多播、简单查询</span></span></code></pre></div><h2 id="应用层可靠性" tabindex="-1">应用层可靠性 <a class="header-anchor" href="#应用层可靠性" aria-label="Permalink to &quot;应用层可靠性&quot;">​</a></h2><p>在 UDP 基础上实现可靠性的常见模式：</p><h3 id="确认与重传" tabindex="-1">确认与重传 <a class="header-anchor" href="#确认与重传" aria-label="Permalink to &quot;确认与重传&quot;">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>发送: 序列号N -&gt; 接收方</span></span>
<span class="line"><span>接收: 确认N -&gt; 发送方</span></span>
<span class="line"><span>超时未确认 -&gt; 重传序列号N</span></span></code></pre></div><h3 id="前向纠错" tabindex="-1">前向纠错 <a class="header-anchor" href="#前向纠错" aria-label="Permalink to &quot;前向纠错&quot;">​</a></h3><p>添加冗余数据，在丢包时恢复信息。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>原始: 数据1, 数据2, 数据3</span></span>
<span class="line"><span>发送: 数据1, 数据2, 数据3, 奇偶校验包</span></span>
<span class="line"><span>丢失数据2 -&gt; 通过数据1、数据3、奇偶校验包恢复</span></span></code></pre></div><h3 id="质量反馈" tabindex="-1">质量反馈 <a class="header-anchor" href="#质量反馈" aria-label="Permalink to &quot;质量反馈&quot;">​</a></h3><p>接收方向发送方报告网络状况，动态调整。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>接收方: 报告丢包率20% -&gt; 发送方降低速率</span></span>
<span class="line"><span>接收方: 报告丢包率5% -&gt; 发送方保持或提高速率</span></span></code></pre></div><h2 id="安全考虑" tabindex="-1">安全考虑 <a class="header-anchor" href="#安全考虑" aria-label="Permalink to &quot;安全考虑&quot;">​</a></h2><h3 id="固有漏洞" tabindex="-1">固有漏洞 <a class="header-anchor" href="#固有漏洞" aria-label="Permalink to &quot;固有漏洞&quot;">​</a></h3><ul><li>无连接性易受洪水攻击</li><li>源地址易伪造</li><li>无拥塞控制可能加剧 DDoS</li></ul><h3 id="防护措施" tabindex="-1">防护措施 <a class="header-anchor" href="#防护措施" aria-label="Permalink to &quot;防护措施&quot;">​</a></h3><ul><li>实施速率限制</li><li>验证数据包真实性</li><li>使用 DTLS (UDP 的 TLS 版本) 加密</li></ul>`,90)])])}const b=s(p,[["render",i]]);export{u as __pageData,b as default};
