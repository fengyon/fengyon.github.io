import{_ as e,c as l,o as s,b as n}from"./chunks/framework.CMLuPXeo.js";const g=JSON.parse('{"title":"Wireshark","description":"","frontmatter":{},"headers":[{"level":2,"title":"介绍","slug":"介绍","link":"#介绍","children":[]},{"level":2,"title":"历史","slug":"历史","link":"#历史","children":[]},{"level":2,"title":"核心架构","slug":"核心架构","link":"#核心架构","children":[{"level":3,"title":"数据包处理流程","slug":"数据包处理流程","link":"#数据包处理流程","children":[]},{"level":3,"title":"系统组成部分","slug":"系统组成部分","link":"#系统组成部分","children":[]}]},{"level":2,"title":"核心特点","slug":"核心特点","link":"#核心特点","children":[{"level":3,"title":"深度协议解析","slug":"深度协议解析","link":"#深度协议解析","children":[]},{"level":3,"title":"强大的过滤系统","slug":"强大的过滤系统","link":"#强大的过滤系统","children":[]},{"level":3,"title":"多平台支持","slug":"多平台支持","link":"#多平台支持","children":[]},{"level":3,"title":"实时流量分析","slug":"实时流量分析","link":"#实时流量分析","children":[]},{"level":3,"title":"数据导入导出","slug":"数据导入导出","link":"#数据导入导出","children":[]},{"level":3,"title":"着色规则","slug":"着色规则","link":"#着色规则","children":[]}]},{"level":2,"title":"工作原理","slug":"工作原理","link":"#工作原理","children":[{"level":3,"title":"数据捕获机制","slug":"数据捕获机制","link":"#数据捕获机制","children":[]},{"level":3,"title":"协议解析过程","slug":"协议解析过程","link":"#协议解析过程","children":[]},{"level":3,"title":"数据流跟踪","slug":"数据流跟踪","link":"#数据流跟踪","children":[]}]},{"level":2,"title":"界面详解","slug":"界面详解","link":"#界面详解","children":[{"level":3,"title":"主窗口布局","slug":"主窗口布局","link":"#主窗口布局","children":[]},{"level":3,"title":"数据包列表列说明","slug":"数据包列表列说明","link":"#数据包列表列说明","children":[]}]},{"level":2,"title":"过滤器系统","slug":"过滤器系统","link":"#过滤器系统","children":[{"level":3,"title":"显示过滤器语法","slug":"显示过滤器语法","link":"#显示过滤器语法","children":[]},{"level":3,"title":"捕获过滤器语法","slug":"捕获过滤器语法","link":"#捕获过滤器语法","children":[]},{"level":3,"title":"过滤器优化技巧","slug":"过滤器优化技巧","link":"#过滤器优化技巧","children":[]}]},{"level":2,"title":"数据包分析","slug":"数据包分析","link":"#数据包分析","children":[{"level":3,"title":"协议层次分析","slug":"协议层次分析","link":"#协议层次分析","children":[]},{"level":3,"title":"流量图形化","slug":"流量图形化","link":"#流量图形化","children":[]},{"level":3,"title":"数据包解析详情","slug":"数据包解析详情","link":"#数据包解析详情","children":[]}]},{"level":2,"title":"高级功能","slug":"高级功能","link":"#高级功能","children":[{"level":3,"title":"数据流重组","slug":"数据流重组","link":"#数据流重组","children":[]},{"level":3,"title":"统计与分析","slug":"统计与分析","link":"#统计与分析","children":[]},{"level":3,"title":"自定义协议解析","slug":"自定义协议解析","link":"#自定义协议解析","children":[]}]},{"level":2,"title":"应用场景","slug":"应用场景","link":"#应用场景","children":[{"level":3,"title":"网络故障排查","slug":"网络故障排查","link":"#网络故障排查","children":[]},{"level":3,"title":"安全分析","slug":"安全分析","link":"#安全分析","children":[]},{"level":3,"title":"协议开发与学习","slug":"协议开发与学习","link":"#协议开发与学习","children":[]},{"level":3,"title":"性能优化","slug":"性能优化","link":"#性能优化","children":[]}]}],"relativePath":"full-stack/network/wireshark.md","filePath":"full-stack/network/wireshark.md"}'),t={name:"full-stack/network/wireshark.md"};function r(i,a,o,h,p,d){return s(),l("div",null,[...a[0]||(a[0]=[n(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /full-stack/network/wireshark.md for this page in Markdown format</div><h1 id="wireshark" tabindex="-1">Wireshark <a class="header-anchor" href="#wireshark" aria-label="Permalink to &quot;Wireshark&quot;">​</a></h1><h2 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h2><p>Wireshark 是一款<strong>免费开源的网络协议分析器</strong>，广泛应用于网络故障排查、性能分析、安全检测和教育研究等领域。它能够<strong>深度捕获并解析网络中传输的数据包</strong>，并以直观的方式展示给用户。作为网络管理员和安全工程师的必备工具，Wireshark 提供了对数百种网络协议的深入洞察，帮助用户理解网络通信的每一个细节。</p><h2 id="历史" tabindex="-1">历史 <a class="header-anchor" href="#历史" aria-label="Permalink to &quot;历史&quot;">​</a></h2><p>Wireshark 由 <strong>Gerald Combs</strong> 于 1998 年创建，最初名为 Ethereal。随着功能的不断完善和社区的持续贡献，该项目在 2006 年更名为 Wireshark。作为开源项目，Wireshark 在 <strong>GNU 通用公共许可证</strong>下发布，由一个活跃的开发者社区维护，并得到 Wireshark 基金会的支持。经过二十多年的发展，Wireshark 已成为<strong>网络分析领域的事实标准</strong>，每年下载量超过 2000 万次，支持超过 20 种语言。</p><h2 id="核心架构" tabindex="-1">核心架构 <a class="header-anchor" href="#核心架构" aria-label="Permalink to &quot;核心架构&quot;">​</a></h2><h3 id="数据包处理流程" tabindex="-1">数据包处理流程 <a class="header-anchor" href="#数据包处理流程" aria-label="Permalink to &quot;数据包处理流程&quot;">​</a></h3><p>Wireshark 采用分层处理架构，数据包经过多个处理阶段：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>网络介质 -&gt; 网卡驱动 -&gt; 捕获过滤器 -&gt; 协议解析器 -&gt; 显示过滤器 -&gt; 用户界面</span></span></code></pre></div><p>这一流程确保了数据从网络到用户的高效、准确传递。</p><h3 id="系统组成部分" tabindex="-1">系统组成部分 <a class="header-anchor" href="#系统组成部分" aria-label="Permalink to &quot;系统组成部分&quot;">​</a></h3><p>Wireshark 界面主要由三个核心窗格组成：</p><ul><li><strong>数据包列表窗格</strong>：显示捕获数据包的摘要信息</li><li><strong>数据包详情窗格</strong>：展示选中数据包的协议层次结构</li><li><strong>数据包字节窗格</strong>：呈现数据包的原始字节内容</li></ul><h2 id="核心特点" tabindex="-1">核心特点 <a class="header-anchor" href="#核心特点" aria-label="Permalink to &quot;核心特点&quot;">​</a></h2><h3 id="深度协议解析" tabindex="-1">深度协议解析 <a class="header-anchor" href="#深度协议解析" aria-label="Permalink to &quot;深度协议解析&quot;">​</a></h3><p>Wireshark 能够<strong>解析数百种网络协议</strong>，从常见的 HTTP、TCP/IP 到专业的工业协议。每个协议都能被分解到字段级别，展示各字段的含义和值。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>HTTP 数据包解析示例：</span></span>
<span class="line"><span>[以太网头][IP头][TCP头][HTTP头][数据]</span></span>
<span class="line"><span>                Wireshark 可深入解析每个部分</span></span></code></pre></div><h3 id="强大的过滤系统" tabindex="-1">强大的过滤系统 <a class="header-anchor" href="#强大的过滤系统" aria-label="Permalink to &quot;强大的过滤系统&quot;">​</a></h3><p>Wireshark 提供<strong>两层过滤机制</strong>：捕获过滤器和显示过滤器。</p><p><strong>捕获过滤器</strong>在数据捕获阶段工作，使用 BPF (Berkeley Packet Filter) 语法：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>tcp port 80 and host 192.168.1.1    # 只捕获该主机的80端口流量</span></span>
<span class="line"><span>not arp                             # 排除ARP流量</span></span></code></pre></div><p>捕获过滤器在开始捕获前设置，<strong>减少不必要的数据收集</strong>。</p><p><strong>显示过滤器</strong>在数据捕获后应用，使用 Wireshark 自有的过滤语言：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>http                     # 只显示HTTP流量</span></span>
<span class="line"><span>ip.src == 192.168.1.1    # 源IP为192.168.1.1的包</span></span>
<span class="line"><span>tcp.port == 80           # 包含80端口的TCP包</span></span></code></pre></div><p>语法正确时过滤器栏显示绿色，错误时显示红色。</p><h3 id="多平台支持" tabindex="-1">多平台支持 <a class="header-anchor" href="#多平台支持" aria-label="Permalink to &quot;多平台支持&quot;">​</a></h3><p>Wireshark 支持 <strong>Windows、macOS、Linux 等多种操作系统</strong>。其统一的用户体验使得在不同平台上进行分析工作具有一致性，便于团队协作和知识共享。</p><h3 id="实时流量分析" tabindex="-1">实时流量分析 <a class="header-anchor" href="#实时流量分析" aria-label="Permalink to &quot;实时流量分析&quot;">​</a></h3><p>Wireshark 支持<strong>实时网络流量捕获与显示</strong>，用户可以边捕获边分析，立即看到网络活动结果。这种能力对于诊断瞬时网络问题至关重要。</p><h3 id="数据导入导出" tabindex="-1">数据导入导出 <a class="header-anchor" href="#数据导入导出" aria-label="Permalink to &quot;数据导入导出&quot;">​</a></h3><p>Wireshark 支持多种格式的数据导入导出，包括 <strong>PCAP、CSV、XML 等</strong>。这便于与其他工具集成和数据共享，同时也支持对捕获文件的事后深入分析。</p><h3 id="着色规则" tabindex="-1">着色规则 <a class="header-anchor" href="#着色规则" aria-label="Permalink to &quot;着色规则&quot;">​</a></h3><p>Wireshark 允许用户<strong>自定义数据包颜色</strong>，基于协议、地址或其他条件进行视觉区分。这种可视化手段让用户能快速识别关键流量模式或异常数据包。</p><h2 id="工作原理" tabindex="-1">工作原理 <a class="header-anchor" href="#工作原理" aria-label="Permalink to &quot;工作原理&quot;">​</a></h2><h3 id="数据捕获机制" tabindex="-1">数据捕获机制 <a class="header-anchor" href="#数据捕获机制" aria-label="Permalink to &quot;数据捕获机制&quot;">​</a></h3><p>Wireshark 使用 <strong>WinPCAP/Libpcap 库</strong>直接与网卡交互，捕获经过的网络数据包。它工作在<strong>混杂模式</strong>下，可以捕获网卡接收到的所有数据包，而不仅仅是发给本机的数据包。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>正常模式: 主机仅接收目标为自身的数据包</span></span>
<span class="line"><span>混杂模式: 主机接收所有流经网络的数据包 &lt;- Wireshark使用此模式</span></span></code></pre></div><h3 id="协议解析过程" tabindex="-1">协议解析过程 <a class="header-anchor" href="#协议解析过程" aria-label="Permalink to &quot;协议解析过程&quot;">​</a></h3><p>Wireshark 采用<strong>协议解码器</strong>对捕获的数据进行层层解析：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>原始字节 -&gt; 以太网帧解析 -&gt; IP包解析 -&gt; TCP/UDP解析 -&gt; 应用层协议解析</span></span></code></pre></div><p>每个解码器理解特定协议的格式，提取并解释各个字段的意义。</p><h3 id="数据流跟踪" tabindex="-1">数据流跟踪 <a class="header-anchor" href="#数据流跟踪" aria-label="Permalink to &quot;数据流跟踪&quot;">​</a></h3><p>Wireshark 能够<strong>重组和分析完整的数据流</strong>，如 HTTP 会话或 FTP 传输。通过“Follow TCP Stream”等功能，用户可以查看完整的客户端-服务器对话，而不必手工拼凑单个数据包。</p><h2 id="界面详解" tabindex="-1">界面详解 <a class="header-anchor" href="#界面详解" aria-label="Permalink to &quot;界面详解&quot;">​</a></h2><h3 id="主窗口布局" tabindex="-1">主窗口布局 <a class="header-anchor" href="#主窗口布局" aria-label="Permalink to &quot;主窗口布局&quot;">​</a></h3><p>Wireshark 主界面包含以下关键元素：</p><ul><li><strong>菜单栏</strong>：提供文件、编辑、视图、捕获、分析等核心功能</li><li><strong>工具栏</strong>：常用功能的快捷访问按钮</li><li><strong>过滤器栏</strong>：应用显示过滤器的输入区域</li><li><strong>数据包列表</strong>：显示捕获数据包的摘要信息</li><li><strong>数据包详情</strong>：展示选中数据包的协议详情</li><li><strong>数据包字节</strong>：以十六进制和 ASCII 格式显示原始数据</li></ul><h3 id="数据包列表列说明" tabindex="-1">数据包列表列说明 <a class="header-anchor" href="#数据包列表列说明" aria-label="Permalink to &quot;数据包列表列说明&quot;">​</a></h3><p>数据包列表窗格包含多个信息列：</p><ul><li><strong>No。</strong>：数据包序列号，按捕获顺序排列</li><li><strong>Time</strong>：数据包捕获时间戳</li><li><strong>Source</strong>：源 IP 地址或主机名</li><li><strong>Destination</strong>：目标 IP 地址或主机名</li><li><strong>Protocol</strong>：数据包使用的最高层协议</li><li><strong>Length</strong>：数据包总长度</li><li><strong>Info</strong>：数据包附加信息</li></ul><h2 id="过滤器系统" tabindex="-1">过滤器系统 <a class="header-anchor" href="#过滤器系统" aria-label="Permalink to &quot;过滤器系统&quot;">​</a></h2><h3 id="显示过滤器语法" tabindex="-1">显示过滤器语法 <a class="header-anchor" href="#显示过滤器语法" aria-label="Permalink to &quot;显示过滤器语法&quot;">​</a></h3><p>显示过滤器支持丰富的表达式语法：</p><p><strong>比较运算符</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>== 等于    != 不等于    &gt; 大于    &lt; 小于    &gt;= 大于等于    &lt;= 小于等于</span></span></code></pre></div><p><strong>逻辑运算符</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>and &amp;&amp; 与    or || 或    not ! 非</span></span></code></pre></div><p><strong>应用示例</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>ip.addr == 192.168.1.1 and tcp.port == 80</span></span>
<span class="line"><span>http.request.method == &quot;POST&quot;</span></span>
<span class="line"><span>frame.len &lt;= 128</span></span></code></pre></div><h3 id="捕获过滤器语法" tabindex="-1">捕获过滤器语法 <a class="header-anchor" href="#捕获过滤器语法" aria-label="Permalink to &quot;捕获过滤器语法&quot;">​</a></h3><p>捕获过滤器使用 BPF 语法，在开始捕获前设置：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>host 192.168.1.1        # 捕获与指定主机相关的流量</span></span>
<span class="line"><span>tcp port 80             # 捕获TCP端口80的流量</span></span>
<span class="line"><span>net 192.168.0.0/24      # 捕获整个子网的流量</span></span></code></pre></div><h3 id="过滤器优化技巧" tabindex="-1">过滤器优化技巧 <a class="header-anchor" href="#过滤器优化技巧" aria-label="Permalink to &quot;过滤器优化技巧&quot;">​</a></h3><ol><li><strong>使用自动完成</strong>：Wireshark 提供过滤器字段的自动完成功能，减少输入错误</li><li><strong>右键应用过滤器</strong>：在数据包详情中右键点击字段，可快速应用为过滤器</li><li><strong>保存常用过滤器</strong>：将常用过滤器保存为快捷方式，提高工作效率</li></ol><h2 id="数据包分析" tabindex="-1">数据包分析 <a class="header-anchor" href="#数据包分析" aria-label="Permalink to &quot;数据包分析&quot;">​</a></h2><h3 id="协议层次分析" tabindex="-1">协议层次分析 <a class="header-anchor" href="#协议层次分析" aria-label="Permalink to &quot;协议层次分析&quot;">​</a></h3><p>Wireshark 提供<strong>协议层次统计</strong>功能，展示捕获流量中各种协议的分布情况。这有助于识别异常协议使用或网络中的意外流量。</p><h3 id="流量图形化" tabindex="-1">流量图形化 <a class="header-anchor" href="#流量图形化" aria-label="Permalink to &quot;流量图形化&quot;">​</a></h3><p>Wireshark 包含多种<strong>流量图形化工具</strong>，如：</p><ul><li><strong>IO 图表</strong>：显示流量随时间的变化趋势</li><li><strong>流量图</strong>：可视化主机之间的对话流程</li><li><strong>往返时间图</strong>：分析 TCP 连接的延迟特性</li></ul><h3 id="数据包解析详情" tabindex="-1">数据包解析详情 <a class="header-anchor" href="#数据包解析详情" aria-label="Permalink to &quot;数据包解析详情&quot;">​</a></h3><p>当选中一个数据包时，详情窗格显示协议的层次结构：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>Frame (物理层信息)</span></span>
<span class="line"><span>Ethernet II (数据链路层)</span></span>
<span class="line"><span>Internet Protocol Version 4 (网络层)</span></span>
<span class="line"><span>Transmission Control Protocol (传输层)</span></span>
<span class="line"><span>Hypertext Transfer Protocol (应用层)</span></span></code></pre></div><p>每一层都可以展开查看具体字段和值。</p><h2 id="高级功能" tabindex="-1">高级功能 <a class="header-anchor" href="#高级功能" aria-label="Permalink to &quot;高级功能&quot;">​</a></h2><h3 id="数据流重组" tabindex="-1">数据流重组 <a class="header-anchor" href="#数据流重组" aria-label="Permalink to &quot;数据流重组&quot;">​</a></h3><p>Wireshark 能够<strong>重组网络会话</strong>，提取传输的文件内容。通过“Export Objects”功能，可以从 HTTP、SMB 等协议中提取传输的文件。</p><h3 id="统计与分析" tabindex="-1">统计与分析 <a class="header-anchor" href="#统计与分析" aria-label="Permalink to &quot;统计与分析&quot;">​</a></h3><p>Wireshark 提供丰富的<strong>统计工具</strong>，包括：</p><ul><li><strong>会话统计</strong>：显示端点之间的对话统计</li><li><strong>协议分级</strong>：按协议类型分类流量</li><li><strong>数据包长度分布</strong>：分析网络负载特征</li></ul><h3 id="自定义协议解析" tabindex="-1">自定义协议解析 <a class="header-anchor" href="#自定义协议解析" aria-label="Permalink to &quot;自定义协议解析&quot;">​</a></h3><p>对于私有或特殊协议，用户可以<strong>编写自己的解析器</strong>，使用 Lua 或 C 语言扩展 Wireshark 的解析能力。这使得 Wireshark 能够适应各种特殊场景。</p><h2 id="应用场景" tabindex="-1">应用场景 <a class="header-anchor" href="#应用场景" aria-label="Permalink to &quot;应用场景&quot;">​</a></h2><h3 id="网络故障排查" tabindex="-1">网络故障排查 <a class="header-anchor" href="#网络故障排查" aria-label="Permalink to &quot;网络故障排查&quot;">​</a></h3><p>Wireshark 是<strong>网络故障诊断的首选工具</strong>，能够识别连接问题、配置错误和性能瓶颈。通过分析实际网络流量，管理员可以准确定位问题根源。</p><h3 id="安全分析" tabindex="-1">安全分析 <a class="header-anchor" href="#安全分析" aria-label="Permalink to &quot;安全分析&quot;">​</a></h3><p>安全工程师使用 Wireshark <strong>检测网络攻击和异常活动</strong>。通过分析恶意流量的特征，可以发现入侵迹象和安全隐患。</p><h3 id="协议开发与学习" tabindex="-1">协议开发与学习 <a class="header-anchor" href="#协议开发与学习" aria-label="Permalink to &quot;协议开发与学习&quot;">​</a></h3><p>开发者和学生利用 Wireshark <strong>深入理解网络协议工作原理</strong>。通过观察实际协议交互，能够获得比文档更直观的理解。</p><h3 id="性能优化" tabindex="-1">性能优化 <a class="header-anchor" href="#性能优化" aria-label="Permalink to &quot;性能优化&quot;">​</a></h3><p>通过分析<strong>网络延迟、重传和流量模式</strong>，Wireshark 帮助识别性能瓶颈，为优化提供数据支持。TCP 重传、零窗口等指标都是关键的性能指示器。</p>`,92)])])}const u=e(t,[["render",r]]);export{g as __pageData,u as default};
