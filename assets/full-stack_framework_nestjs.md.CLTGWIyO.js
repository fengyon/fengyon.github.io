import{_ as n,c as a,o as l,b as p}from"./chunks/framework.CMLuPXeo.js";const F=JSON.parse('{"title":"Nest.js","description":"","frontmatter":{},"headers":[{"level":2,"title":"核心概念与架构设计","slug":"核心概念与架构设计","link":"#核心概念与架构设计","children":[{"level":3,"title":"分层架构","slug":"分层架构","link":"#分层架构","children":[]},{"level":3,"title":"模块系统","slug":"模块系统","link":"#模块系统","children":[]},{"level":3,"title":"依赖注入","slug":"依赖注入","link":"#依赖注入","children":[]}]},{"level":2,"title":"主要特性","slug":"主要特性","link":"#主要特性","children":[{"level":3,"title":"面向切面编程 (AOP)","slug":"面向切面编程-aop","link":"#面向切面编程-aop","children":[]},{"level":3,"title":"企业级框架支持","slug":"企业级框架支持","link":"#企业级框架支持","children":[]},{"level":3,"title":"平台无关性","slug":"平台无关性","link":"#平台无关性","children":[]}]},{"level":2,"title":"快速开始","slug":"快速开始","link":"#快速开始","children":[{"level":3,"title":"环境准备","slug":"环境准备","link":"#环境准备","children":[]},{"level":3,"title":"创建新项目","slug":"创建新项目","link":"#创建新项目","children":[]},{"level":3,"title":"项目目录结构","slug":"项目目录结构","link":"#项目目录结构","children":[]},{"level":3,"title":"启动应用","slug":"启动应用","link":"#启动应用","children":[]}]},{"level":2,"title":"核心组件详解","slug":"核心组件详解","link":"#核心组件详解","children":[{"level":3,"title":"模块 (Modules)","slug":"模块-modules","link":"#模块-modules","children":[]},{"level":3,"title":"控制器 (Controllers)","slug":"控制器-controllers","link":"#控制器-controllers","children":[]},{"level":3,"title":"服务 (Providers)","slug":"服务-providers","link":"#服务-providers","children":[]},{"level":3,"title":"完整的模块示例","slug":"完整的模块示例","link":"#完整的模块示例","children":[]}]},{"level":2,"title":"常用装饰器","slug":"常用装饰器","link":"#常用装饰器","children":[{"level":3,"title":"请求装饰器","slug":"请求装饰器","link":"#请求装饰器","children":[]},{"level":3,"title":"DTO (数据传输对象)","slug":"dto-数据传输对象","link":"#dto-数据传输对象","children":[]}]},{"level":2,"title":"中间件和守卫","slug":"中间件和守卫","link":"#中间件和守卫","children":[{"level":3,"title":"中间件","slug":"中间件","link":"#中间件","children":[]},{"level":3,"title":"守卫","slug":"守卫","link":"#守卫","children":[]}]},{"level":2,"title":"异常处理","slug":"异常处理","link":"#异常处理","children":[]},{"level":2,"title":"数据库集成","slug":"数据库集成","link":"#数据库集成","children":[{"level":3,"title":"使用 TypeORM","slug":"使用-typeorm","link":"#使用-typeorm","children":[]}]},{"level":2,"title":"生态系统","slug":"生态系统","link":"#生态系统","children":[{"level":3,"title":"常用官方模块","slug":"常用官方模块","link":"#常用官方模块","children":[]},{"level":3,"title":"配置管理示例","slug":"配置管理示例","link":"#配置管理示例","children":[]}]}],"relativePath":"full-stack/framework/nestjs.md","filePath":"full-stack/framework/nestjs.md"}'),o={name:"full-stack/framework/nestjs.md"};function e(t,s,c,r,E,y){return l(),a("div",null,[...s[0]||(s[0]=[p(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /full-stack/framework/nestjs.md for this page in Markdown format</div><h1 id="nest-js" tabindex="-1">Nest.js <a class="header-anchor" href="#nest-js" aria-label="Permalink to &quot;Nest.js&quot;">​</a></h1><p>Nest.js 是一个用于构建高效、可扩展的 <code>Node.js</code> 服务器端应用程序的开发框架。它使用 <code>TypeScript</code> 构建，并完全支持 <code>TypeScript</code> (也允许使用纯 <code>JavaScript</code> 编程)，结合了面向对象编程 (<code>OOP</code>)、函数式编程 (<code>FP</code>) 和函数式响应式编程 (<code>FRP</code>) 的元素。</p><h2 id="核心概念与架构设计" tabindex="-1">核心概念与架构设计 <a class="header-anchor" href="#核心概念与架构设计" aria-label="Permalink to &quot;核心概念与架构设计&quot;">​</a></h2><p>Nest.js 的核心思想是提供开箱即用的应用程序架构，允许开发者创建高度可测试、可扩展、松耦合且易于维护的应用程序。</p><h3 id="分层架构" tabindex="-1">分层架构 <a class="header-anchor" href="#分层架构" aria-label="Permalink to &quot;分层架构&quot;">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────┐</span></span>
<span class="line"><span>│   Controllers   │  ← HTTP请求入口层</span></span>
<span class="line"><span>└─────────────────┘</span></span>
<span class="line"><span>         ↓</span></span>
<span class="line"><span>┌─────────────────┐</span></span>
<span class="line"><span>│    Services     │  ← 业务逻辑处理层</span></span>
<span class="line"><span>└─────────────────┘</span></span>
<span class="line"><span>         ↓</span></span>
<span class="line"><span>┌─────────────────┐</span></span>
<span class="line"><span>│  Repositories   │  ← 数据访问层</span></span>
<span class="line"><span>└─────────────────┘</span></span></code></pre></div><h3 id="模块系统" tabindex="-1">模块系统 <a class="header-anchor" href="#模块系统" aria-label="Permalink to &quot;模块系统&quot;">​</a></h3><p>Nest.js 采用模块化架构，每个应用程序至少有一个根模块 (<code>AppModule</code>)，你可以根据需要创建多个特性模块。</p><p><strong>模块关系示意图：</strong></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>AppModule (根模块)</span></span>
<span class="line"><span>├── UsersModule (用户模块)</span></span>
<span class="line"><span>├── AuthModule (认证模块)  </span></span>
<span class="line"><span>└── ProductsModule (产品模块)</span></span></code></pre></div><h3 id="依赖注入" tabindex="-1">依赖注入 <a class="header-anchor" href="#依赖注入" aria-label="Permalink to &quot;依赖注入&quot;">​</a></h3><p>Nest.js 内置了依赖注入容器，自动管理组件之间的依赖关系。</p><p><strong>依赖注入流程：</strong></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>ComponentA 需要 ComponentB</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>IoC容器创建ComponentB实例</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>IoC容器将ComponentB注入到ComponentA</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>ComponentA直接使用ComponentB</span></span></code></pre></div><h2 id="主要特性" tabindex="-1">主要特性 <a class="header-anchor" href="#主要特性" aria-label="Permalink to &quot;主要特性&quot;">​</a></h2><h3 id="面向切面编程-aop" tabindex="-1">面向切面编程 (AOP) <a class="header-anchor" href="#面向切面编程-aop" aria-label="Permalink to &quot;面向切面编程 (AOP)&quot;">​</a></h3><p>Nest.js 通过拦截器、中间件、守卫等实现 AOP，允许你将横切关注点 (如日志、认证、异常处理) 与业务逻辑分离。</p><h3 id="企业级框架支持" tabindex="-1">企业级框架支持 <a class="header-anchor" href="#企业级框架支持" aria-label="Permalink to &quot;企业级框架支持&quot;">​</a></h3><p>Nest.js 提供了完整的开箱即用体验，包含大量企业级应用所需的特性：</p><ul><li>依赖注入容器</li><li>模块化系统</li><li>配置管理</li><li>验证和序列化</li><li>认证和授权</li><li>数据库集成</li><li>测试工具</li></ul><h3 id="平台无关性" tabindex="-1">平台无关性 <a class="header-anchor" href="#平台无关性" aria-label="Permalink to &quot;平台无关性&quot;">​</a></h3><p>虽然 Nest.js 默认使用 <code>Express</code>，但它构建在平台无关的架构上，可以轻松切换到其他 HTTP 框架如 <code>Fastify</code>。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 使用 Express 平台</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { NestFactory } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/core&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { NestExpressApplication } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/platform-express&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> app</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> NestFactory.</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">NestExpressApplication</span><span style="color:#E1E4E8;">&gt;(AppModule);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 使用 Fastify 平台  </span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { NestFastifyApplication } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/platform-fastify&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> app</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> NestFactory.</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">NestFastifyApplication</span><span style="color:#E1E4E8;">&gt;(AppModule);</span></span></code></pre></div><h2 id="快速开始" tabindex="-1">快速开始 <a class="header-anchor" href="#快速开始" aria-label="Permalink to &quot;快速开始&quot;">​</a></h2><h3 id="环境准备" tabindex="-1">环境准备 <a class="header-anchor" href="#环境准备" aria-label="Permalink to &quot;环境准备&quot;">​</a></h3><p>确保已安装 <code>Node.js</code> (v14 及以上版本)，然后安装 Nest.js CLI：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">npm</span><span style="color:#9ECBFF;"> i</span><span style="color:#79B8FF;"> -g</span><span style="color:#9ECBFF;"> @nestjs/cli</span></span></code></pre></div><h3 id="创建新项目" tabindex="-1">创建新项目 <a class="header-anchor" href="#创建新项目" aria-label="Permalink to &quot;创建新项目&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">nest</span><span style="color:#9ECBFF;"> new</span><span style="color:#9ECBFF;"> my-nest-app</span></span></code></pre></div><h3 id="项目目录结构" tabindex="-1">项目目录结构 <a class="header-anchor" href="#项目目录结构" aria-label="Permalink to &quot;项目目录结构&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">src/</span></span>
<span class="line"><span style="color:#B392F0;">├──</span><span style="color:#9ECBFF;"> app.module.ts</span><span style="color:#6A737D;">          # 应用程序的根模块</span></span>
<span class="line"><span style="color:#B392F0;">├──</span><span style="color:#9ECBFF;"> app.controller.ts</span><span style="color:#6A737D;">      # 基本控制器</span></span>
<span class="line"><span style="color:#B392F0;">├──</span><span style="color:#9ECBFF;"> app.service.ts</span><span style="color:#6A737D;">         # 基本服务</span></span>
<span class="line"><span style="color:#B392F0;">└──</span><span style="color:#9ECBFF;"> main.ts</span><span style="color:#6A737D;">                # 应用程序入口文件</span></span></code></pre></div><h3 id="启动应用" tabindex="-1">启动应用 <a class="header-anchor" href="#启动应用" aria-label="Permalink to &quot;启动应用&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#9ECBFF;"> my-nest-app</span></span>
<span class="line"><span style="color:#B392F0;">npm</span><span style="color:#9ECBFF;"> run</span><span style="color:#9ECBFF;"> start:dev</span></span></code></pre></div><p>访问 <code>http://localhost:3000</code> 即可看到运行结果。</p><h2 id="核心组件详解" tabindex="-1">核心组件详解 <a class="header-anchor" href="#核心组件详解" aria-label="Permalink to &quot;核心组件详解&quot;">​</a></h2><h3 id="模块-modules" tabindex="-1">模块 (Modules) <a class="header-anchor" href="#模块-modules" aria-label="Permalink to &quot;模块 (Modules)&quot;">​</a></h3><p>模块是用 <code>@Module()</code> 装饰器注解的类，它组织了应用程序的结构。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Module</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  imports: [UsersModule, AuthModule],      </span><span style="color:#6A737D;">// 导入的其他模块</span></span>
<span class="line"><span style="color:#E1E4E8;">  controllers: [UsersController],          </span><span style="color:#6A737D;">// 该模块的控制器</span></span>
<span class="line"><span style="color:#E1E4E8;">  providers: [UsersService],               </span><span style="color:#6A737D;">// 该模块的服务</span></span>
<span class="line"><span style="color:#E1E4E8;">  exports: [UsersService]                  </span><span style="color:#6A737D;">// 导出给其他模块使用</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> UsersModule</span><span style="color:#E1E4E8;"> {}</span></span></code></pre></div><h3 id="控制器-controllers" tabindex="-1">控制器 (Controllers) <a class="header-anchor" href="#控制器-controllers" aria-label="Permalink to &quot;控制器 (Controllers)&quot;">​</a></h3><p>控制器负责处理传入的请求和返回响应。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Controller, Get, Post, Body, Param } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Controller</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;users&#39;</span><span style="color:#E1E4E8;">)  </span><span style="color:#6A737D;">// 路由前缀 &#39;/users&#39;</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> UsersController</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">()              </span><span style="color:#6A737D;">// GET /users</span></span>
<span class="line"><span style="color:#B392F0;">  getAllUsers</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#9ECBFF;"> &#39;所有用户列表&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;:id&#39;</span><span style="color:#E1E4E8;">)         </span><span style="color:#6A737D;">// GET /users/1</span></span>
<span class="line"><span style="color:#B392F0;">  getUser</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Param</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#FFAB70;">id</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#9ECBFF;"> \`用户 ID: \${</span><span style="color:#E1E4E8;">id</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Post</span><span style="color:#E1E4E8;">()             </span><span style="color:#6A737D;">// POST /users</span></span>
<span class="line"><span style="color:#B392F0;">  createUser</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Body</span><span style="color:#E1E4E8;">() </span><span style="color:#FFAB70;">userData</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> any</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#9ECBFF;"> \`创建用户: \${</span><span style="color:#79B8FF;">JSON</span><span style="color:#9ECBFF;">.</span><span style="color:#B392F0;">stringify</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">userData</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h3 id="服务-providers" tabindex="-1">服务 (Providers) <a class="header-anchor" href="#服务-providers" aria-label="Permalink to &quot;服务 (Providers)&quot;">​</a></h3><p>服务是 Nest.js 的业务逻辑层，使用 <code>@Injectable()</code> 装饰器。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Injectable } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> interface</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#FFAB70;">  id</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> number</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#FFAB70;">  name</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#FFAB70;">  email</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Injectable</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> UsersService</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">  private</span><span style="color:#F97583;"> readonly</span><span style="color:#FFAB70;"> users</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;">[] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  create</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">user</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#79B8FF;">    this</span><span style="color:#E1E4E8;">.users.</span><span style="color:#B392F0;">push</span><span style="color:#E1E4E8;">(user);</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#E1E4E8;"> user;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  findAll</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;">[] {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.users;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  findOne</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">id</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> number</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.users.</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">user</span><span style="color:#F97583;"> =&gt;</span><span style="color:#E1E4E8;"> user.id </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> id);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h3 id="完整的模块示例" tabindex="-1">完整的模块示例 <a class="header-anchor" href="#完整的模块示例" aria-label="Permalink to &quot;完整的模块示例&quot;">​</a></h3><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// user.entity.ts</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#FFAB70;">  id</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> number</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#FFAB70;">  name</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#FFAB70;">  email</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// users.service.ts</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Injectable } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { User } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./user.entity&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Injectable</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> UsersService</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">  private</span><span style="color:#FFAB70;"> users</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;">[] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [</span></span>
<span class="line"><span style="color:#E1E4E8;">    { id: </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, name: </span><span style="color:#9ECBFF;">&#39;张三&#39;</span><span style="color:#E1E4E8;">, email: </span><span style="color:#9ECBFF;">&#39;zhangsan@example.com&#39;</span><span style="color:#E1E4E8;"> },</span></span>
<span class="line"><span style="color:#E1E4E8;">    { id: </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, name: </span><span style="color:#9ECBFF;">&#39;李四&#39;</span><span style="color:#E1E4E8;">, email: </span><span style="color:#9ECBFF;">&#39;lisi@example.com&#39;</span><span style="color:#E1E4E8;"> }</span></span>
<span class="line"><span style="color:#E1E4E8;">  ];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  findAll</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;">[] {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.users;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  findOne</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">id</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> number</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.users.</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">user</span><span style="color:#F97583;"> =&gt;</span><span style="color:#E1E4E8;"> user.id </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> id);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  create</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">user</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> newUser</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> { </span><span style="color:#F97583;">...</span><span style="color:#E1E4E8;">user, id: </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.users.</span><span style="color:#79B8FF;">length</span><span style="color:#F97583;"> +</span><span style="color:#79B8FF;"> 1</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"><span style="color:#79B8FF;">    this</span><span style="color:#E1E4E8;">.users.</span><span style="color:#B392F0;">push</span><span style="color:#E1E4E8;">(newUser);</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#E1E4E8;"> newUser;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// users.controller.ts</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Controller, Get, Param, Post, Body } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { UsersService } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./users.service&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { User } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./user.entity&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Controller</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;users&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> UsersController</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">  constructor</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">private</span><span style="color:#F97583;"> readonly</span><span style="color:#FFAB70;"> usersService</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> UsersService</span><span style="color:#E1E4E8;">) {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#B392F0;">  getAllUsers</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;">[] {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.usersService.</span><span style="color:#B392F0;">findAll</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;:id&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">  getUser</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Param</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#FFAB70;">id</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.usersService.</span><span style="color:#B392F0;">findOne</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;">id);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Post</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#B392F0;">  createUser</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Body</span><span style="color:#E1E4E8;">() </span><span style="color:#FFAB70;">userData</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.usersService.</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">(userData);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// users.module.ts</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Module } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { UsersController } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./users.controller&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { UsersService } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./users.service&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Module</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  controllers: [UsersController],</span></span>
<span class="line"><span style="color:#E1E4E8;">  providers: [UsersService],</span></span>
<span class="line"><span style="color:#E1E4E8;">  exports: [UsersService]  </span><span style="color:#6A737D;">// 导出服务，供其他模块使用</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> UsersModule</span><span style="color:#E1E4E8;"> {}</span></span></code></pre></div><h2 id="常用装饰器" tabindex="-1">常用装饰器 <a class="header-anchor" href="#常用装饰器" aria-label="Permalink to &quot;常用装饰器&quot;">​</a></h2><h3 id="请求装饰器" tabindex="-1">请求装饰器 <a class="header-anchor" href="#请求装饰器" aria-label="Permalink to &quot;请求装饰器&quot;">​</a></h3><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Controller, Get, Post, Param, Query, Body, Headers, Req, Res } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Request, Response } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;express&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Controller</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;examples&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> ExamplesController</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;query&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">  getWithQuery</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Query</span><span style="color:#E1E4E8;">() </span><span style="color:#FFAB70;">query</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> any</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#9ECBFF;"> \`查询参数: \${</span><span style="color:#79B8FF;">JSON</span><span style="color:#9ECBFF;">.</span><span style="color:#B392F0;">stringify</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">query</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;:id&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">  getWithParam</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Param</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#FFAB70;">id</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#9ECBFF;"> \`参数 ID: \${</span><span style="color:#E1E4E8;">id</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Post</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#B392F0;">  createWithBody</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Body</span><span style="color:#E1E4E8;">() </span><span style="color:#FFAB70;">body</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> any</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#9ECBFF;"> \`请求体: \${</span><span style="color:#79B8FF;">JSON</span><span style="color:#9ECBFF;">.</span><span style="color:#B392F0;">stringify</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">body</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;headers&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">  getWithHeaders</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Headers</span><span style="color:#E1E4E8;">() </span><span style="color:#FFAB70;">headers</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> any</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#9ECBFF;"> \`请求头: \${</span><span style="color:#79B8FF;">JSON</span><span style="color:#9ECBFF;">.</span><span style="color:#B392F0;">stringify</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">headers</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  // 使用平台特定的请求/响应对象</span></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;native/req&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">  getNativeReq</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Req</span><span style="color:#E1E4E8;">() </span><span style="color:#FFAB70;">req</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> Request</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#9ECBFF;"> \`原始请求 URL: \${</span><span style="color:#E1E4E8;">req</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">url</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;native/res&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">  getNativeRes</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Res</span><span style="color:#E1E4E8;">() </span><span style="color:#FFAB70;">res</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> Response</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#E1E4E8;"> res.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">200</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">json</span><span style="color:#E1E4E8;">({ message: </span><span style="color:#9ECBFF;">&#39;直接响应&#39;</span><span style="color:#E1E4E8;"> });</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h3 id="dto-数据传输对象" tabindex="-1">DTO (数据传输对象) <a class="header-anchor" href="#dto-数据传输对象" aria-label="Permalink to &quot;DTO (数据传输对象)&quot;">​</a></h3><p>使用 <code>DTO</code> 来定义接口请求和响应的数据结构：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// create-user.dto.ts</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { IsString, IsEmail, MinLength } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;class-validator&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> CreateUserDto</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">IsString</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">MinLength</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#FFAB70;">  name</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">IsEmail</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#FFAB70;">  email</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// users.controller.ts</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Post</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#B392F0;">createUser</span><span style="color:#E1E4E8;">(@</span><span style="color:#B392F0;">Body</span><span style="color:#E1E4E8;">() createUserDto: CreateUserDto) {</span></span>
<span class="line"><span style="color:#6A737D;">  // Nest.js 会自动验证 createUserDto</span></span>
<span class="line"><span style="color:#F97583;">  return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.usersService.</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">(createUserDto);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h2 id="中间件和守卫" tabindex="-1">中间件和守卫 <a class="header-anchor" href="#中间件和守卫" aria-label="Permalink to &quot;中间件和守卫&quot;">​</a></h2><h3 id="中间件" tabindex="-1">中间件 <a class="header-anchor" href="#中间件" aria-label="Permalink to &quot;中间件&quot;">​</a></h3><p>中间件在路由处理程序之前调用，可以访问请求和响应对象。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Injectable, NestMiddleware } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Injectable</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> LoggerMiddleware</span><span style="color:#F97583;"> implements</span><span style="color:#B392F0;"> NestMiddleware</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  use</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">req</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> any</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">res</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> any</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">next</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#79B8FF;"> void</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`[\${</span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> Date</span><span style="color:#9ECBFF;">().</span><span style="color:#B392F0;">toISOString</span><span style="color:#9ECBFF;">()</span><span style="color:#9ECBFF;">}] \${</span><span style="color:#E1E4E8;">req</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">method</span><span style="color:#9ECBFF;">} \${</span><span style="color:#E1E4E8;">req</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">url</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#B392F0;">    next</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 在模块中应用中间件</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> AppModule</span><span style="color:#F97583;"> implements</span><span style="color:#B392F0;"> NestModule</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  configure</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">consumer</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> MiddlewareConsumer</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    consumer</span></span>
<span class="line"><span style="color:#E1E4E8;">      .</span><span style="color:#B392F0;">apply</span><span style="color:#E1E4E8;">(LoggerMiddleware)</span></span>
<span class="line"><span style="color:#E1E4E8;">      .</span><span style="color:#B392F0;">forRoutes</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;*&#39;</span><span style="color:#E1E4E8;">);  </span><span style="color:#6A737D;">// 应用到所有路由</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h3 id="守卫" tabindex="-1">守卫 <a class="header-anchor" href="#守卫" aria-label="Permalink to &quot;守卫&quot;">​</a></h3><p>守卫用于实现认证和授权逻辑：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Injectable, CanActivate, ExecutionContext } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Observable } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;rxjs&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Injectable</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> AuthGuard</span><span style="color:#F97583;"> implements</span><span style="color:#B392F0;"> CanActivate</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  canActivate</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#FFAB70;">    context</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> ExecutionContext</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  )</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> boolean</span><span style="color:#F97583;"> |</span><span style="color:#B392F0;"> Promise</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">boolean</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#F97583;">|</span><span style="color:#B392F0;"> Observable</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">boolean</span><span style="color:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> request</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> context.</span><span style="color:#B392F0;">switchToHttp</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getRequest</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">validateRequest</span><span style="color:#E1E4E8;">(request);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  private</span><span style="color:#B392F0;"> validateRequest</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">request</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> any</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> boolean</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#6A737D;">    // 实现你的认证逻辑</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> token</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> request.headers[</span><span style="color:#9ECBFF;">&#39;authorization&#39;</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#F97583;"> !!</span><span style="color:#E1E4E8;">token; </span><span style="color:#6A737D;">// 简单示例，实际需要更复杂的验证</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 使用守卫</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Controller</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;protected&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">UseGuards</span><span style="color:#E1E4E8;">(AuthGuard)</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> ProtectedController</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#B392F0;">  getProtectedData</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#9ECBFF;"> &#39;这是受保护的数据&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h2 id="异常处理" tabindex="-1">异常处理 <a class="header-anchor" href="#异常处理" aria-label="Permalink to &quot;异常处理&quot;">​</a></h2><p>Nest.js 提供了内置的异常层，可以自动处理应用程序中抛出的所有异常。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { </span></span>
<span class="line"><span style="color:#E1E4E8;">  Controller, Get, </span></span>
<span class="line"><span style="color:#E1E4E8;">  HttpException, HttpStatus </span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Controller</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;exceptions&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> ExceptionsController</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;not-found&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">  getNotFound</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#F97583;">    throw</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> HttpException</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;资源未找到&#39;</span><span style="color:#E1E4E8;">, HttpStatus.</span><span style="color:#79B8FF;">NOT_FOUND</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;custom&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">  getCustomError</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#F97583;">    throw</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> HttpException</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">      status: HttpStatus.</span><span style="color:#79B8FF;">BAD_REQUEST</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      error: </span><span style="color:#9ECBFF;">&#39;这是自定义错误消息&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      timestamp: </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> Date</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">toISOString</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    }, HttpStatus.</span><span style="color:#79B8FF;">BAD_REQUEST</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 自定义异常过滤器</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { ExceptionFilter, Catch, ArgumentsHost } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Catch</span><span style="color:#E1E4E8;">(HttpException)</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> HttpExceptionFilter</span><span style="color:#F97583;"> implements</span><span style="color:#B392F0;"> ExceptionFilter</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  catch</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">exception</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> HttpException</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">host</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> ArgumentsHost</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> ctx</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> host.</span><span style="color:#B392F0;">switchToHttp</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> response</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> ctx.</span><span style="color:#B392F0;">getResponse</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> request</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> ctx.</span><span style="color:#B392F0;">getRequest</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> status</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> exception.</span><span style="color:#B392F0;">getStatus</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    response.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">(status).</span><span style="color:#B392F0;">json</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">      statusCode: status,</span></span>
<span class="line"><span style="color:#E1E4E8;">      timestamp: </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> Date</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">toISOString</span><span style="color:#E1E4E8;">(),</span></span>
<span class="line"><span style="color:#E1E4E8;">      path: request.url,</span></span>
<span class="line"><span style="color:#E1E4E8;">      message: exception.message</span></span>
<span class="line"><span style="color:#E1E4E8;">    });</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h2 id="数据库集成" tabindex="-1">数据库集成 <a class="header-anchor" href="#数据库集成" aria-label="Permalink to &quot;数据库集成&quot;">​</a></h2><h3 id="使用-typeorm" tabindex="-1">使用 TypeORM <a class="header-anchor" href="#使用-typeorm" aria-label="Permalink to &quot;使用 TypeORM&quot;">​</a></h3><p><code>TypeORM</code> 是 Nest.js 官方推荐的 <code>ORM</code>，支持多种数据库。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// user.entity.ts</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Entity, Column, PrimaryGeneratedColumn } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;typeorm&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Entity</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">PrimaryGeneratedColumn</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#FFAB70;">  id</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> number</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Column</span><span style="color:#E1E4E8;">({ length: </span><span style="color:#79B8FF;">30</span><span style="color:#E1E4E8;"> })</span></span>
<span class="line"><span style="color:#FFAB70;">  name</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Column</span><span style="color:#E1E4E8;">({ unique: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> })</span></span>
<span class="line"><span style="color:#FFAB70;">  email</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  @</span><span style="color:#B392F0;">Column</span><span style="color:#E1E4E8;">({ default: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> })</span></span>
<span class="line"><span style="color:#FFAB70;">  isActive</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> boolean</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// users.service.ts</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Injectable } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { InjectRepository } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/typeorm&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Repository } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;typeorm&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { User } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./user.entity&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Injectable</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> UsersService</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">  constructor</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#B392F0;">InjectRepository</span><span style="color:#E1E4E8;">(User)</span></span>
<span class="line"><span style="color:#F97583;">    private</span><span style="color:#FFAB70;"> usersRepository</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> Repository</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;">&gt;,</span></span>
<span class="line"><span style="color:#E1E4E8;">  ) {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  findAll</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> Promise</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;">[]&gt; {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.usersRepository.</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  findOne</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">id</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> number</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> Promise</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.usersRepository.</span><span style="color:#B392F0;">findOneBy</span><span style="color:#E1E4E8;">({ id });</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  async</span><span style="color:#B392F0;"> create</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">user</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> User</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> Promise</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.usersRepository.</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">(user);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  async</span><span style="color:#B392F0;"> remove</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">id</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> number</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> Promise</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">void</span><span style="color:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="color:#F97583;">    await</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.usersRepository.</span><span style="color:#B392F0;">delete</span><span style="color:#E1E4E8;">(id);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// users.module.ts</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Module } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { TypeOrmModule } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/typeorm&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { UsersService } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./users.service&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { UsersController } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./users.controller&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { User } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./user.entity&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Module</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  imports: [TypeOrmModule.</span><span style="color:#B392F0;">forFeature</span><span style="color:#E1E4E8;">([User])],</span></span>
<span class="line"><span style="color:#E1E4E8;">  controllers: [UsersController],</span></span>
<span class="line"><span style="color:#E1E4E8;">  providers: [UsersService],</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> UsersModule</span><span style="color:#E1E4E8;"> {}</span></span></code></pre></div><h2 id="生态系统" tabindex="-1">生态系统 <a class="header-anchor" href="#生态系统" aria-label="Permalink to &quot;生态系统&quot;">​</a></h2><p>Nest.js 拥有丰富的生态系统，提供了大量官方和第三方模块：</p><h3 id="常用官方模块" tabindex="-1">常用官方模块 <a class="header-anchor" href="#常用官方模块" aria-label="Permalink to &quot;常用官方模块&quot;">​</a></h3><ul><li><code>@nestjs/config</code> - 配置管理</li><li><code>@nestjs/jwt</code> + <code>@nestjs/passport</code> - 用户认证授权</li><li><code>@nestjs/swagger</code> - API 文档生成</li><li><code>@nestjs/cache-manager</code> - 缓存系统</li><li><code>@nestjs/schedule</code> - 定时任务</li><li><code>@nestjs/websockets</code> - WebSocket 支持</li><li><code>@nestjs/microservices</code> - 微服务架构</li></ul><h3 id="配置管理示例" tabindex="-1">配置管理示例 <a class="header-anchor" href="#配置管理示例" aria-label="Permalink to &quot;配置管理示例&quot;">​</a></h3><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// app.module.ts</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Module } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { ConfigModule } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/config&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Module</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  imports: [</span></span>
<span class="line"><span style="color:#E1E4E8;">    ConfigModule.</span><span style="color:#B392F0;">forRoot</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">      isGlobal: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,  </span><span style="color:#6A737D;">// 全局可用</span></span>
<span class="line"><span style="color:#E1E4E8;">      envFilePath: </span><span style="color:#9ECBFF;">&#39;.env&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    }),</span></span>
<span class="line"><span style="color:#E1E4E8;">  ],</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> AppModule</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// config.service.ts</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Injectable } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { ConfigService } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@nestjs/config&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">Injectable</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> class</span><span style="color:#B392F0;"> AppConfigService</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">  constructor</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">private</span><span style="color:#FFAB70;"> configService</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> ConfigService</span><span style="color:#E1E4E8;">) {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  get</span><span style="color:#B392F0;"> databaseHost</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.configService.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">&gt;(</span><span style="color:#9ECBFF;">&#39;DATABASE_HOST&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  get</span><span style="color:#B392F0;"> databasePort</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> number</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> this</span><span style="color:#E1E4E8;">.configService.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">number</span><span style="color:#E1E4E8;">&gt;(</span><span style="color:#9ECBFF;">&#39;DATABASE_PORT&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><p>Nest.js 通过其模块化架构、依赖注入系统和丰富的生态系统，为构建企业级 <code>Node.js</code> 应用程序提供了完整的解决方案。其优雅的设计模式和强大的类型支持使得开发大规模应用变得更加可维护和可扩展。</p>`,74)])])}const d=n(o,[["render",e]]);export{F as __pageData,d as default};
