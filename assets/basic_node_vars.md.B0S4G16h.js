import{_ as n,c as a,o as l,b as p}from"./chunks/framework.CMLuPXeo.js";const F=JSON.parse('{"title":"node 全局变量","description":"","frontmatter":{},"headers":[{"level":2,"title":"全局对象与作用域","slug":"全局对象与作用域","link":"#全局对象与作用域","children":[{"level":3,"title":"global 对象","slug":"global-对象","link":"#global-对象","children":[]},{"level":3,"title":"模块作用域变量","slug":"模块作用域变量","link":"#模块作用域变量","children":[]}]},{"level":2,"title":"进程控制全局变量","slug":"进程控制全局变量","link":"#进程控制全局变量","children":[{"level":3,"title":"process 对象","slug":"process-对象","link":"#process-对象","children":[]},{"level":3,"title":"进程事件处理","slug":"进程事件处理","link":"#进程事件处理","children":[]}]},{"level":2,"title":"定时器全局变量","slug":"定时器全局变量","link":"#定时器全局变量","children":[{"level":3,"title":"setTimeout 和 setInterval","slug":"settimeout-和-setinterval","link":"#settimeout-和-setinterval","children":[]}]},{"level":2,"title":"缓冲区与编码全局变量","slug":"缓冲区与编码全局变量","link":"#缓冲区与编码全局变量","children":[{"level":3,"title":"Buffer 类","slug":"buffer-类","link":"#buffer-类","children":[]},{"level":3,"title":"文本编码器","slug":"文本编码器","link":"#文本编码器","children":[]}]},{"level":2,"title":"控制台全局变量","slug":"控制台全局变量","link":"#控制台全局变量","children":[{"level":3,"title":"console 对象","slug":"console-对象","link":"#console-对象","children":[]}]},{"level":2,"title":"URL 处理全局变量","slug":"url-处理全局变量","link":"#url-处理全局变量","children":[{"level":3,"title":"URL 类","slug":"url-类","link":"#url-类","children":[]},{"level":3,"title":"URLSearchParams 类","slug":"urlsearchparams-类","link":"#urlsearchparams-类","children":[]}]},{"level":2,"title":"工具函数全局变量","slug":"工具函数全局变量","link":"#工具函数全局变量","children":[{"level":3,"title":"性能测量","slug":"性能测量","link":"#性能测量","children":[]},{"level":3,"title":"实用工具","slug":"实用工具","link":"#实用工具","children":[]}]},{"level":2,"title":"全局变量使用最佳实践","slug":"全局变量使用最佳实践","link":"#全局变量使用最佳实践","children":[{"level":3,"title":"避免全局污染","slug":"避免全局污染","link":"#避免全局污染","children":[]},{"level":3,"title":"环境特定代码","slug":"环境特定代码","link":"#环境特定代码","children":[]},{"level":3,"title":"错误处理模式","slug":"错误处理模式","link":"#错误处理模式","children":[]}]}],"relativePath":"basic/node/vars.md","filePath":"basic/node/vars.md"}'),o={name:"basic/node/vars.md"};function e(c,s,t,r,E,y){return l(),a("div",null,[...s[0]||(s[0]=[p(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /basic/node/vars.md for this page in Markdown format</div><h1 id="node-全局变量" tabindex="-1">node 全局变量 <a class="header-anchor" href="#node-全局变量" aria-label="Permalink to &quot;node 全局变量&quot;">​</a></h1><p>Node.js 全局变量是在所有模块中均可直接访问的变量和对象，无需使用 <code>require()</code> 导入。这些变量提供了 Node.js 运行时环境的核心功能，包括进程控制、模块系统、定时器等。与浏览器环境不同，Node.js 的全局对象是 <code>global</code> 而不是 <code>window</code>。</p><h2 id="全局对象与作用域" tabindex="-1">全局对象与作用域 <a class="header-anchor" href="#全局对象与作用域" aria-label="Permalink to &quot;全局对象与作用域&quot;">​</a></h2><p>在 Node.js 中，全局变量存在于多个层次的作用域中。最顶层的全局对象是 <code>global</code>，其属性在所有模块中均可直接访问。</p><p>作用域示意图：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>global (顶层对象)</span></span>
<span class="line"><span>  ├── 模块作用域 (当前文件)</span></span>
<span class="line"><span>  ├── 函数作用域</span></span>
<span class="line"><span>  └── 块级作用域</span></span></code></pre></div><h3 id="global-对象" tabindex="-1">global 对象 <a class="header-anchor" href="#global-对象" aria-label="Permalink to &quot;global 对象&quot;">​</a></h3><p><code>global</code> 对象是 Node.js 的顶层命名空间，其属性在任何地方都可直接访问：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 直接访问 global 属性</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(global </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> globalThis); </span><span style="color:#6A737D;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 在 global 上定义属性</span></span>
<span class="line"><span style="color:#E1E4E8;">global.appName </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;MyNodeApp&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 在任何地方都可访问</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(appName); </span><span style="color:#6A737D;">// &#39;MyNodeApp&#39;</span></span></code></pre></div><h3 id="模块作用域变量" tabindex="-1">模块作用域变量 <a class="header-anchor" href="#模块作用域变量" aria-label="Permalink to &quot;模块作用域变量&quot;">​</a></h3><p>每个模块都有自己独立的作用域，但可以通过特定变量访问模块信息：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 当前模块的目录名</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(__dirname); </span><span style="color:#6A737D;">// /path/to/current/directory</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 当前模块的文件名</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(__filename); </span><span style="color:#6A737D;">// /path/to/current/file.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 模块导出对象</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">typeof</span><span style="color:#79B8FF;"> module</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// object</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 模块导出对象</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">typeof</span><span style="color:#79B8FF;"> exports</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// object</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// require 函数</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">typeof</span><span style="color:#E1E4E8;"> require); </span><span style="color:#6A737D;">// function</span></span></code></pre></div><h2 id="进程控制全局变量" tabindex="-1">进程控制全局变量 <a class="header-anchor" href="#进程控制全局变量" aria-label="Permalink to &quot;进程控制全局变量&quot;">​</a></h2><h3 id="process-对象" tabindex="-1">process 对象 <a class="header-anchor" href="#process-对象" aria-label="Permalink to &quot;process 对象&quot;">​</a></h3><p><code>process</code> 对象提供当前 Node.js 进程的信息和控制：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 进程信息</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;进程ID:&#39;</span><span style="color:#E1E4E8;">, process.pid);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Node版本:&#39;</span><span style="color:#E1E4E8;">, process.version);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;平台:&#39;</span><span style="color:#E1E4E8;">, process.platform);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 环境变量</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;用户HOME目录:&#39;</span><span style="color:#E1E4E8;">, process.env.</span><span style="color:#79B8FF;">HOME</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Node环境:&#39;</span><span style="color:#E1E4E8;">, process.env.</span><span style="color:#79B8FF;">NODE_ENV</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 工作目录</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;当前工作目录:&#39;</span><span style="color:#E1E4E8;">, process.</span><span style="color:#B392F0;">cwd</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 内存使用情况</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;内存使用:&#39;</span><span style="color:#E1E4E8;">, process.</span><span style="color:#B392F0;">memoryUsage</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 命令行参数</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;命令行参数:&#39;</span><span style="color:#E1E4E8;">, process.argv);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 设置环境变量</span></span>
<span class="line"><span style="color:#E1E4E8;">process.env.</span><span style="color:#79B8FF;">MY_VAR</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &#39;custom value&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre></div><h3 id="进程事件处理" tabindex="-1">进程事件处理 <a class="header-anchor" href="#进程事件处理" aria-label="Permalink to &quot;进程事件处理&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 进程退出事件</span></span>
<span class="line"><span style="color:#E1E4E8;">process.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;exit&#39;</span><span style="color:#E1E4E8;">, (</span><span style="color:#FFAB70;">code</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`进程即将退出，退出码: \${</span><span style="color:#E1E4E8;">code</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 未捕获异常处理</span></span>
<span class="line"><span style="color:#E1E4E8;">process.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;uncaughtException&#39;</span><span style="color:#E1E4E8;">, (</span><span style="color:#FFAB70;">err</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;未捕获的异常:&#39;</span><span style="color:#E1E4E8;">, err);</span></span>
<span class="line"><span style="color:#E1E4E8;">  process.</span><span style="color:#B392F0;">exit</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 信号处理</span></span>
<span class="line"><span style="color:#E1E4E8;">process.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;SIGINT&#39;</span><span style="color:#E1E4E8;">, () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;收到 SIGINT 信号&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  process.</span><span style="color:#B392F0;">exit</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 强制退出</span></span>
<span class="line"><span style="color:#E1E4E8;">process.</span><span style="color:#B392F0;">exit</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 正常退出</span></span></code></pre></div><h2 id="定时器全局变量" tabindex="-1">定时器全局变量 <a class="header-anchor" href="#定时器全局变量" aria-label="Permalink to &quot;定时器全局变量&quot;">​</a></h2><p>Node.js 提供了与浏览器类似的定时器函数，但基于不同的实现机制：</p><h3 id="settimeout-和-setinterval" tabindex="-1">setTimeout 和 setInterval <a class="header-anchor" href="#settimeout-和-setinterval" aria-label="Permalink to &quot;setTimeout 和 setInterval&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// setTimeout - 一次性定时器</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> timeoutId</span><span style="color:#F97583;"> =</span><span style="color:#B392F0;"> setTimeout</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;这段代码在 1 秒后执行&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}, </span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 清除定时器</span></span>
<span class="line"><span style="color:#B392F0;">clearTimeout</span><span style="color:#E1E4E8;">(timeoutId);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// setInterval - 间隔定时器</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> count </span><span style="color:#F97583;">=</span><span style="color:#79B8FF;"> 0</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> intervalId</span><span style="color:#F97583;"> =</span><span style="color:#B392F0;"> setInterval</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  count</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`第 \${</span><span style="color:#E1E4E8;">count</span><span style="color:#9ECBFF;">} 次执行\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#F97583;">  if</span><span style="color:#E1E4E8;"> (count </span><span style="color:#F97583;">&gt;=</span><span style="color:#79B8FF;"> 5</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#B392F0;">    clearInterval</span><span style="color:#E1E4E8;">(intervalId);</span></span>
<span class="line"><span style="color:#E1E4E8;">    console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;定时器已停止&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}, </span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// setImmediate - 在当前事件循环结束时执行</span></span>
<span class="line"><span style="color:#B392F0;">setImmediate</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;立即执行回调&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 执行顺序示例</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;开始&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#B392F0;">setTimeout</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;setTimeout&#39;</span><span style="color:#E1E4E8;">), </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#B392F0;">setImmediate</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;setImmediate&#39;</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;结束&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 输出顺序:</span></span>
<span class="line"><span style="color:#6A737D;">// 开始</span></span>
<span class="line"><span style="color:#6A737D;">// 结束  </span></span>
<span class="line"><span style="color:#6A737D;">// setTimeout 或 setImmediate (顺序不确定)</span></span>
<span class="line"><span style="color:#6A737D;">// setImmediate 或 setTimeout</span></span></code></pre></div><p>执行流程示意图：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>主线程 --&gt; 定时器注册 --&gt; 事件循环 --&gt; 回调执行</span></span>
<span class="line"><span>    ↑        ↓            ↓</span></span>
<span class="line"><span>    └--------检查定时器---执行</span></span></code></pre></div><h2 id="缓冲区与编码全局变量" tabindex="-1">缓冲区与编码全局变量 <a class="header-anchor" href="#缓冲区与编码全局变量" aria-label="Permalink to &quot;缓冲区与编码全局变量&quot;">​</a></h2><h3 id="buffer-类" tabindex="-1">Buffer 类 <a class="header-anchor" href="#buffer-类" aria-label="Permalink to &quot;Buffer 类&quot;">​</a></h3><p><code>Buffer</code> 类用于处理二进制数据，是 Node.js 中处理文件、网络流等的核心：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 创建 Buffer</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> buf1</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> Buffer.</span><span style="color:#B392F0;">from</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Hello World&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> buf2</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> Buffer.</span><span style="color:#B392F0;">from</span><span style="color:#E1E4E8;">([</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> buf3</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> Buffer.</span><span style="color:#B392F0;">alloc</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 创建 10 字节的 Buffer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Buffer 操作</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(buf1.</span><span style="color:#B392F0;">toString</span><span style="color:#E1E4E8;">()); </span><span style="color:#6A737D;">// &#39;Hello World&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(buf1.</span><span style="color:#B392F0;">toString</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;base64&#39;</span><span style="color:#E1E4E8;">)); </span><span style="color:#6A737D;">// &#39;SGVsbG8gV29ybGQ=&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Buffer 拼接</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> buf4</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> Buffer.</span><span style="color:#B392F0;">concat</span><span style="color:#E1E4E8;">([buf1, buf2]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Buffer 比较</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(Buffer.</span><span style="color:#B392F0;">compare</span><span style="color:#E1E4E8;">(buf1, buf2));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Buffer 填充</span></span>
<span class="line"><span style="color:#E1E4E8;">buf3.</span><span style="color:#B392F0;">fill</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 用 0 填充</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 获取 Buffer 信息</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Buffer 长度:&#39;</span><span style="color:#E1E4E8;">, buf1.</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Buffer 内容:&#39;</span><span style="color:#E1E4E8;">, buf1);</span></span></code></pre></div><h3 id="文本编码器" tabindex="-1">文本编码器 <a class="header-anchor" href="#文本编码器" aria-label="Permalink to &quot;文本编码器&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// TextEncoder 和 TextDecoder (在较新 Node.js 版本中可用)</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> encoder</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> TextEncoder</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> decoder</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> TextDecoder</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> uint8Array</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> encoder.</span><span style="color:#B392F0;">encode</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Hello World&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;编码结果:&#39;</span><span style="color:#E1E4E8;">, uint8Array);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> text</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> decoder.</span><span style="color:#B392F0;">decode</span><span style="color:#E1E4E8;">(uint8Array);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;解码结果:&#39;</span><span style="color:#E1E4E8;">, text);</span></span></code></pre></div><h2 id="控制台全局变量" tabindex="-1">控制台全局变量 <a class="header-anchor" href="#控制台全局变量" aria-label="Permalink to &quot;控制台全局变量&quot;">​</a></h2><h3 id="console-对象" tabindex="-1">console 对象 <a class="header-anchor" href="#console-对象" aria-label="Permalink to &quot;console 对象&quot;">​</a></h3><p><code>console</code> 对象提供了丰富的输出方法，支持格式化输出：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 基本输出</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;普通日志&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">info</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;信息日志&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">warn</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;警告日志&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;错误日志&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 断言</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">assert</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#F97583;"> +</span><span style="color:#79B8FF;"> 2</span><span style="color:#F97583;"> ===</span><span style="color:#79B8FF;"> 5</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;数学出错了!&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 计数</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">count</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;计数器&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">count</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;计数器&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">countReset</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;计数器&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 分组输出</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">group</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;用户信息&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;姓名: John&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;年龄: 30&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">groupEnd</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 表格输出</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">table</span><span style="color:#E1E4E8;">([</span></span>
<span class="line"><span style="color:#E1E4E8;">  { name: </span><span style="color:#9ECBFF;">&#39;John&#39;</span><span style="color:#E1E4E8;">, age: </span><span style="color:#79B8FF;">30</span><span style="color:#E1E4E8;"> },</span></span>
<span class="line"><span style="color:#E1E4E8;">  { name: </span><span style="color:#9ECBFF;">&#39;Jane&#39;</span><span style="color:#E1E4E8;">, age: </span><span style="color:#79B8FF;">25</span><span style="color:#E1E4E8;"> }</span></span>
<span class="line"><span style="color:#E1E4E8;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 时间测量</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">time</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;操作计时&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 模拟耗时操作</span></span>
<span class="line"><span style="color:#B392F0;">setTimeout</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">timeEnd</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;操作计时&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}, </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 堆栈跟踪</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">trace</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;当前位置&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><h2 id="url-处理全局变量" tabindex="-1">URL 处理全局变量 <a class="header-anchor" href="#url-处理全局变量" aria-label="Permalink to &quot;URL 处理全局变量&quot;">​</a></h2><h3 id="url-类" tabindex="-1">URL 类 <a class="header-anchor" href="#url-类" aria-label="Permalink to &quot;URL 类&quot;">​</a></h3><p><code>URL</code> 类提供了符合标准的 URL 解析和构造功能：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// URL 解析</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> myURL</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> URL</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;https://example.com:8080/path/name?query=string#hash&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;协议:&#39;</span><span style="color:#E1E4E8;">, myURL.protocol); </span><span style="color:#6A737D;">// https:</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;主机名:&#39;</span><span style="color:#E1E4E8;">, myURL.hostname); </span><span style="color:#6A737D;">// example.com</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;端口:&#39;</span><span style="color:#E1E4E8;">, myURL.port); </span><span style="color:#6A737D;">// 8080</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;路径:&#39;</span><span style="color:#E1E4E8;">, myURL.pathname); </span><span style="color:#6A737D;">// /path/name</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;查询参数:&#39;</span><span style="color:#E1E4E8;">, myURL.search); </span><span style="color:#6A737D;">// ?query=string</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;哈希:&#39;</span><span style="color:#E1E4E8;">, myURL.hash); </span><span style="color:#6A737D;">// #hash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 获取查询参数</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> params</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> myURL.searchParams;</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;query 参数:&#39;</span><span style="color:#E1E4E8;">, params.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;query&#39;</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 设置查询参数</span></span>
<span class="line"><span style="color:#E1E4E8;">params.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;page&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">params.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;sort&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;name&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;完整URL:&#39;</span><span style="color:#E1E4E8;">, myURL.href);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// URL 格式化</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;字符串形式:&#39;</span><span style="color:#E1E4E8;">, myURL.</span><span style="color:#B392F0;">toString</span><span style="color:#E1E4E8;">());</span></span></code></pre></div><h3 id="urlsearchparams-类" tabindex="-1">URLSearchParams 类 <a class="header-anchor" href="#urlsearchparams-类" aria-label="Permalink to &quot;URLSearchParams 类&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 操作查询参数</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> searchParams</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> URLSearchParams</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;key1=value1&amp;key2=value2&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 遍历参数</span></span>
<span class="line"><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> [</span><span style="color:#79B8FF;">key</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">value</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">of</span><span style="color:#E1E4E8;"> searchParams) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`\${</span><span style="color:#E1E4E8;">key</span><span style="color:#9ECBFF;">}: \${</span><span style="color:#E1E4E8;">value</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 操作方法</span></span>
<span class="line"><span style="color:#E1E4E8;">searchParams.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;key3&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;value3&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">searchParams.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;key1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;newvalue&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">searchParams.</span><span style="color:#B392F0;">delete</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;key2&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;是否有 key1:&#39;</span><span style="color:#E1E4E8;">, searchParams.</span><span style="color:#B392F0;">has</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;key1&#39;</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;所有值:&#39;</span><span style="color:#E1E4E8;">, searchParams.</span><span style="color:#B392F0;">toString</span><span style="color:#E1E4E8;">());</span></span></code></pre></div><h2 id="工具函数全局变量" tabindex="-1">工具函数全局变量 <a class="header-anchor" href="#工具函数全局变量" aria-label="Permalink to &quot;工具函数全局变量&quot;">​</a></h2><h3 id="性能测量" tabindex="-1">性能测量 <a class="header-anchor" href="#性能测量" aria-label="Permalink to &quot;性能测量&quot;">​</a></h3><p><code>performance</code> 对象提供了高精度的时间测量功能：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 性能测量</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">performance</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> require</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;perf_hooks&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> startTime</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> performance.</span><span style="color:#B392F0;">now</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 模拟耗时操作</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> sum </span><span style="color:#F97583;">=</span><span style="color:#79B8FF;"> 0</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#79B8FF;"> 0</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#79B8FF;"> 1000000</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  sum </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> i;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> endTime</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> performance.</span><span style="color:#B392F0;">now</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`操作耗时: \${</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">endTime</span><span style="color:#F97583;"> -</span><span style="color:#E1E4E8;"> startTime</span><span style="color:#9ECBFF;">).</span><span style="color:#B392F0;">toFixed</span><span style="color:#9ECBFF;">(</span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">} 毫秒\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 性能标记</span></span>
<span class="line"><span style="color:#E1E4E8;">performance.</span><span style="color:#B392F0;">mark</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;start&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 执行一些操作</span></span>
<span class="line"><span style="color:#E1E4E8;">performance.</span><span style="color:#B392F0;">mark</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;end&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">performance.</span><span style="color:#B392F0;">measure</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;操作耗时&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;start&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;end&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> measure</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> performance.</span><span style="color:#B392F0;">getEntriesByName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;操作耗时&#39;</span><span style="color:#E1E4E8;">)[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;测量结果:&#39;</span><span style="color:#E1E4E8;">, measure);</span></span></code></pre></div><h3 id="实用工具" tabindex="-1">实用工具 <a class="header-anchor" href="#实用工具" aria-label="Permalink to &quot;实用工具&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 文本格式化</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> name</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &#39;John&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> age</span><span style="color:#F97583;"> =</span><span style="color:#79B8FF;"> 30</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(util.</span><span style="color:#B392F0;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;姓名: %s, 年龄: %d&#39;</span><span style="color:#E1E4E8;">, name, age));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 回调转 Promise</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">promisify</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> require</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;util&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> fs</span><span style="color:#F97583;"> =</span><span style="color:#B392F0;"> require</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;fs&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> readFileAsync</span><span style="color:#F97583;"> =</span><span style="color:#B392F0;"> promisify</span><span style="color:#E1E4E8;">(fs.readFile);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 现在可以使用 async/await</span></span>
<span class="line"><span style="color:#F97583;">async</span><span style="color:#F97583;"> function</span><span style="color:#B392F0;"> readConfig</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#F97583;">  try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> data</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#B392F0;"> readFileAsync</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;config.json&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;utf8&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#79B8FF;"> JSON</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">parse</span><span style="color:#E1E4E8;">(data);</span></span>
<span class="line"><span style="color:#E1E4E8;">  } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (error) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    console.</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;读取配置失败:&#39;</span><span style="color:#E1E4E8;">, error);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 类型检查</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(util.types.</span><span style="color:#B392F0;">isDate</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> Date</span><span style="color:#E1E4E8;">())); </span><span style="color:#6A737D;">// true</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(util.types.</span><span style="color:#B392F0;">isRegExp</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">/</span><span style="color:#DBEDFF;">abc</span><span style="color:#9ECBFF;">/</span><span style="color:#E1E4E8;">)); </span><span style="color:#6A737D;">// true</span></span></code></pre></div><h2 id="全局变量使用最佳实践" tabindex="-1">全局变量使用最佳实践 <a class="header-anchor" href="#全局变量使用最佳实践" aria-label="Permalink to &quot;全局变量使用最佳实践&quot;">​</a></h2><h3 id="避免全局污染" tabindex="-1">避免全局污染 <a class="header-anchor" href="#避免全局污染" aria-label="Permalink to &quot;避免全局污染&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 不好的做法 - 污染全局命名空间</span></span>
<span class="line"><span style="color:#E1E4E8;">global.myData </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> { </span><span style="color:#6A737D;">/* 大量数据 */</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 好的做法 - 使用模块导出</span></span>
<span class="line"><span style="color:#6A737D;">// config.js</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> const</span><span style="color:#79B8FF;"> appConfig</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#6A737D;">  // 配置数据</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 其他文件</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { appConfig } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./config.js&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre></div><h3 id="环境特定代码" tabindex="-1">环境特定代码 <a class="header-anchor" href="#环境特定代码" aria-label="Permalink to &quot;环境特定代码&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 检查运行环境</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">typeof</span><span style="color:#E1E4E8;"> window </span><span style="color:#F97583;">!==</span><span style="color:#9ECBFF;"> &#39;undefined&#39;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#6A737D;">  // 浏览器环境代码</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;运行在浏览器中&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#6A737D;">  // Node.js 环境代码</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;运行在 Node.js 中&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 特性检测</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">typeof</span><span style="color:#E1E4E8;"> Buffer </span><span style="color:#F97583;">!==</span><span style="color:#9ECBFF;"> &#39;undefined&#39;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#6A737D;">  // 可以使用 Buffer</span></span>
<span class="line"><span style="color:#F97583;">  const</span><span style="color:#79B8FF;"> buf</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> Buffer.</span><span style="color:#B392F0;">from</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;text&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><h3 id="错误处理模式" tabindex="-1">错误处理模式 <a class="header-anchor" href="#错误处理模式" aria-label="Permalink to &quot;错误处理模式&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 全局错误处理</span></span>
<span class="line"><span style="color:#E1E4E8;">process.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;unhandledRejection&#39;</span><span style="color:#E1E4E8;">, (</span><span style="color:#FFAB70;">reason</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">promise</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;未处理的 Promise 拒绝:&#39;</span><span style="color:#E1E4E8;">, reason);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 异步错误处理</span></span>
<span class="line"><span style="color:#F97583;">async</span><span style="color:#F97583;"> function</span><span style="color:#B392F0;"> main</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#F97583;">  try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> result</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#B392F0;"> someAsyncOperation</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#E1E4E8;"> result;</span></span>
<span class="line"><span style="color:#E1E4E8;">  } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (error) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    console.</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;操作失败:&#39;</span><span style="color:#E1E4E8;">, error);</span></span>
<span class="line"><span style="color:#F97583;">    throw</span><span style="color:#E1E4E8;"> error;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 使用 process.exit 的注意事项</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> gracefulShutdown</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;正在关闭应用...&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">  // 清理资源</span></span>
<span class="line"><span style="color:#B392F0;">  setTimeout</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    process.</span><span style="color:#B392F0;">exit</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }, </span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">process.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;SIGTERM&#39;</span><span style="color:#E1E4E8;">, gracefulShutdown);</span></span></code></pre></div>`,54)])])}const d=n(o,[["render",e]]);export{F as __pageData,d as default};
