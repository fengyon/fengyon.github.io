import{_ as n,c as a,o as p,b as l}from"./chunks/framework.CMLuPXeo.js";const F=JSON.parse('{"title":"DApp 开发","description":"","frontmatter":{},"headers":[{"level":2,"title":"什么是 DApp？","slug":"什么是-dapp","link":"#什么是-dapp","children":[]},{"level":2,"title":"DApp 的技术架构","slug":"dapp-的技术架构","link":"#dapp-的技术架构","children":[]},{"level":2,"title":"DApp 的核心开发流程","slug":"dapp-的核心开发流程","link":"#dapp-的核心开发流程","children":[{"level":3,"title":"需求分析与架构设计","slug":"需求分析与架构设计","link":"#需求分析与架构设计","children":[]},{"level":3,"title":"智能合约开发","slug":"智能合约开发","link":"#智能合约开发","children":[]},{"level":3,"title":"前端集成与交互实现","slug":"前端集成与交互实现","link":"#前端集成与交互实现","children":[]},{"level":3,"title":"测试、部署与运维自动化","slug":"测试、部署与运维自动化","link":"#测试、部署与运维自动化","children":[]}]},{"level":2,"title":"常用开源库与 API 示例","slug":"常用开源库与-api-示例","link":"#常用开源库与-api-示例","children":[{"level":3,"title":"Ethers.js","slug":"ethers-js","link":"#ethers-js","children":[]},{"level":3,"title":"Web3.js","slug":"web3-js","link":"#web3-js","children":[]},{"level":3,"title":"OpenZeppelin 合约库","slug":"openzeppelin-合约库","link":"#openzeppelin-合约库","children":[]}]}],"relativePath":"leading/web3/dapp-development.md","filePath":"leading/web3/dapp-development.md"}'),o={name:"leading/web3/dapp-development.md"};function e(t,s,c,r,E,y){return p(),a("div",null,[...s[0]||(s[0]=[l(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /leading/web3/dapp-development.md for this page in Markdown format</div><h1 id="dapp-开发" tabindex="-1">DApp 开发 <a class="header-anchor" href="#dapp-开发" aria-label="Permalink to &quot;DApp 开发&quot;">​</a></h1><h2 id="什么是-dapp" tabindex="-1">什么是 DApp？ <a class="header-anchor" href="#什么是-dapp" aria-label="Permalink to &quot;什么是 DApp？&quot;">​</a></h2><p>DApp (去中心化应用) 是在去中心化网络 (如区块链) 上运行的应用，结合了智能合约和前端用户界面。与传统应用依赖中心化服务器不同，DApp 的后端逻辑通过部署在区块链上的智能合约执行，数据存储在分布式网络中，从而消除单点控制并增强透明度和抗审查性。</p><p>DApp 的基本交互流程可以简化表示如下：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>用户界面 (前端) -- 发起交易 --&gt; 钱包 (签名) -- 广播 --&gt; 区块链网络 (智能合约处理并更新状态)</span></span></code></pre></div><h2 id="dapp-的技术架构" tabindex="-1">DApp 的技术架构 <a class="header-anchor" href="#dapp-的技术架构" aria-label="Permalink to &quot;DApp 的技术架构&quot;">​</a></h2><p>典型的 DApp 采用分层设计，核心包括：</p><p><strong>前端界面</strong>：用户直接交互的网页或应用，通常使用传统 Web 技术 (如 JavaScript、HTML、CSS) 构建。</p><p><strong>智能合约</strong>：部署在区块链上的业务逻辑，处理核心操作。例如，在以太坊上，合约通常用 Solidity 编写。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>合约状态 (链上存储) &lt;--&gt; 合约函数 (逻辑) &lt;--&gt; 触发事件</span></span></code></pre></div><p><strong>区块链连接层</strong>：前端通过特定的 JavaScript 库 (如 Ethers.js、Web3.js) 与区块链网络交互。这些库充当桥梁，将前端的操作指令转换为区块链能理解的交易。</p><p><strong>去中心化存储</strong>：为应对区块链存储成本高的问题，静态前端资源、用户数据等可存储在去中心化存储系统 (如 IPFS) 中。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>前端资源 (HTML, CSS, JS) -- 存储于 --&gt; IPFS 网络 -- 通过内容标识符 (CID) 访问</span></span></code></pre></div><h2 id="dapp-的核心开发流程" tabindex="-1">DApp 的核心开发流程 <a class="header-anchor" href="#dapp-的核心开发流程" aria-label="Permalink to &quot;DApp 的核心开发流程&quot;">​</a></h2><h3 id="需求分析与架构设计" tabindex="-1">需求分析与架构设计 <a class="header-anchor" href="#需求分析与架构设计" aria-label="Permalink to &quot;需求分析与架构设计&quot;">​</a></h3><p>开发始于明确的需求分析和目标设定，这决定了后续的设计边界与优先级。需要围绕目标用户和真实场景锁定核心功能，并建立需求变更治理机制。随后进行架构设计，绘制高层系统图，明确前端、后端、合约的职责边界，并评估链上调用次数和 Gas 成本。</p><h3 id="智能合约开发" tabindex="-1">智能合约开发 <a class="header-anchor" href="#智能合约开发" aria-label="Permalink to &quot;智能合约开发&quot;">​</a></h3><p>智能合约是 DApp 的核心，其开发需遵循可预测的行为与稳定的状态机原则。编写时应优先采用可读性强的实现，并附带充分注释。常用的安全模式包括防重放、可重入保护和原子性事务。在代码层面，要引入自动化静态分析、单元测试和覆盖率检查，确保变更可控。</p><h3 id="前端集成与交互实现" tabindex="-1">前端集成与交互实现 <a class="header-anchor" href="#前端集成与交互实现" aria-label="Permalink to &quot;前端集成与交互实现&quot;">​</a></h3><p>前端对接是用户体验的关键环节，需通过钱包连接、签名流程和状态更新实现流畅交互。在前后端协作中，应约定统一的事件和错误处理机制，确保可追踪性。把合约事件映射为前端状态，可以减少用户等待时间。</p><h3 id="测试、部署与运维自动化" tabindex="-1">测试、部署与运维自动化 <a class="header-anchor" href="#测试、部署与运维自动化" aria-label="Permalink to &quot;测试、部署与运维自动化&quot;">​</a></h3><p>测试、部署与运维是提升 DApp 可靠性的重要环节。先在测试网络全面验证功能、边界与安全性。再通过 CI/CD 管道实现从提交到上线的自动化流程。对生产环境设置监控、日志和告警，以缩短故障恢复时间。</p><h2 id="常用开源库与-api-示例" tabindex="-1">常用开源库与 API 示例 <a class="header-anchor" href="#常用开源库与-api-示例" aria-label="Permalink to &quot;常用开源库与 API 示例&quot;">​</a></h2><h3 id="ethers-js" tabindex="-1">Ethers.js <a class="header-anchor" href="#ethers-js" aria-label="Permalink to &quot;Ethers.js&quot;">​</a></h3><p>Ethers.js 是一个轻量级、功能强大且设计现代的 JavaScript 库，专注于提供一个安全、易用且可扩展的以太坊钱包和 DApp 交互界面。它对 TypeScript 的支持非常完善，提供准确的类型定义。</p><p>以下是一些常用 API 的 ESM 格式使用示例：</p><p><strong>连接钱包并获取账户地址</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { BrowserProvider } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;ethers&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 检测浏览器中的钱包（如 MetaMask）</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> provider</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> BrowserProvider</span><span style="color:#E1E4E8;">(window.ethereum);</span></span>
<span class="line"><span style="color:#6A737D;">// 请求连接账户</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> signer</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> provider.</span><span style="color:#B392F0;">getSigner</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#6A737D;">// 获取账户地址</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> address</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> signer.</span><span style="color:#B392F0;">getAddress</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Connected account: \${</span><span style="color:#E1E4E8;">address</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><p><strong>读取链上数据 (例如获取 ETH 余额)</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { BrowserProvider } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;ethers&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> provider</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> BrowserProvider</span><span style="color:#E1E4E8;">(window.ethereum);</span></span>
<span class="line"><span style="color:#6A737D;">// 获取指定地址的 ETH 余额</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> balance</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> provider.</span><span style="color:#B392F0;">getBalance</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;0x742E4fB0d55b3526A5C0f42b5aA7C68F52752B6D&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 将余额从 Wei 转换为 ETH</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Balance: \${</span><span style="color:#E1E4E8;">ethers</span><span style="color:#9ECBFF;">.</span><span style="color:#B392F0;">formatEther</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">balance</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">} ETH\`</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><p><strong>与智能合约交互 (以读取 ERC-20 代币余额为例)</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { BrowserProvider, Contract } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;ethers&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#6A737D;">// ERC-20 代币标准的 ABI（部分函数）</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> erc20Abi</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> [</span></span>
<span class="line"><span style="color:#9ECBFF;">  &quot;function balanceOf(address owner) view returns (uint256)&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#9ECBFF;">  &quot;function symbol() view returns (string)&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> provider</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> BrowserProvider</span><span style="color:#E1E4E8;">(window.ethereum);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> signer</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> provider.</span><span style="color:#B392F0;">getSigner</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 创建合约实例，连接到一个 USDT 合约地址</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> contract</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Contract</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;0xdAC17F958D2ee523a2206206994597C13D831ec7&quot;</span><span style="color:#E1E4E8;">, erc20Abi, signer);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 调用合约的 symbol 函数</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> symbol</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> contract.</span><span style="color:#B392F0;">symbol</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#6A737D;">// 调用合约的 balanceOf 函数查询指定地址余额</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> balance</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> contract.</span><span style="color:#B392F0;">balanceOf</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> signer.</span><span style="color:#B392F0;">getAddress</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Balance: \${</span><span style="color:#E1E4E8;">ethers</span><span style="color:#9ECBFF;">.</span><span style="color:#B392F0;">formatUnits</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">balance</span><span style="color:#9ECBFF;">, </span><span style="color:#79B8FF;">6</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">} \${</span><span style="color:#E1E4E8;">symbol</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// USDT 通常使用 6 位小数</span></span></code></pre></div><p><strong>发送交易 (以转账 ETH 为例)</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { BrowserProvider } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;ethers&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> provider</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> BrowserProvider</span><span style="color:#E1E4E8;">(window.ethereum);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> signer</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> provider.</span><span style="color:#B392F0;">getSigner</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 构建交易对象</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> transaction</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  to: </span><span style="color:#9ECBFF;">&quot;0x742E4fB0d55b3526A5C0f42b5aA7C68F52752B6D&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  value: ethers.</span><span style="color:#B392F0;">parseEther</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;0.01&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#6A737D;">// 转账 0.01 ETH</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 发送交易</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> txResponse</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> signer.</span><span style="color:#B392F0;">sendTransaction</span><span style="color:#E1E4E8;">(transaction);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Transaction hash: \${</span><span style="color:#E1E4E8;">txResponse</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">hash</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 等待交易被打包</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> receipt</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> txResponse.</span><span style="color:#B392F0;">wait</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Transaction confirmed in block: \${</span><span style="color:#E1E4E8;">receipt</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">blockNumber</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><h3 id="web3-js" tabindex="-1">Web3.js <a class="header-anchor" href="#web3-js" aria-label="Permalink to &quot;Web3.js&quot;">​</a></h3><p>Web3.js 是以太坊官方推荐的 JavaScript 库，拥有悠久的历史和庞大的用户基数。它提供了与以太坊节点交互的几乎所有功能。</p><p>以下是一些常用 API 的 ESM 格式使用示例：</p><p><strong>初始化并连接提供商</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> Web3 </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;web3&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 假设使用浏览器注入的 MetaMask 提供商</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> web3</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Web3</span><span style="color:#E1E4E8;">(window.ethereum);</span></span>
<span class="line"><span style="color:#6A737D;">// 请求账户访问</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> window.ethereum.</span><span style="color:#B392F0;">request</span><span style="color:#E1E4E8;">({ method: </span><span style="color:#9ECBFF;">&#39;eth_requestAccounts&#39;</span><span style="color:#E1E4E8;"> });</span></span></code></pre></div><p><strong>获取账户信息及余额</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> Web3 </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;web3&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> web3</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Web3</span><span style="color:#E1E4E8;">(window.ethereum);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 获取账户列表</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> accounts</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> web3.eth.</span><span style="color:#B392F0;">getAccounts</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> currentAccount</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> accounts[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Connected account: \${</span><span style="color:#E1E4E8;">currentAccount</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 获取 ETH 余额</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> balanceWei</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> web3.eth.</span><span style="color:#B392F0;">getBalance</span><span style="color:#E1E4E8;">(currentAccount);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> balanceEth</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> web3.utils.</span><span style="color:#B392F0;">fromWei</span><span style="color:#E1E4E8;">(balanceWei, </span><span style="color:#9ECBFF;">&#39;ether&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Balance: \${</span><span style="color:#E1E4E8;">balanceEth</span><span style="color:#9ECBFF;">} ETH\`</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><p><strong>与智能合约交互 (以写入合约为示例)</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> Web3 </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;web3&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> web3</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Web3</span><span style="color:#E1E4E8;">(window.ethereum);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 合约 ABI 和地址</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> contractAbi</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> [ </span><span style="color:#6A737D;">/* ... 合约 ABI ... */</span><span style="color:#E1E4E8;"> ];</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> contractAddress</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &quot;0x...&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 创建合约实例</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> myContract</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#E1E4E8;"> web3.eth.</span><span style="color:#B392F0;">Contract</span><span style="color:#E1E4E8;">(contractAbi, contractAddress);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> accounts</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> web3.eth.</span><span style="color:#B392F0;">getAccounts</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 调用合约的 setMinter 函数（需要消耗 Gas 的写入操作）</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> receipt</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> myContract.methods</span></span>
<span class="line"><span style="color:#E1E4E8;">  .</span><span style="color:#B392F0;">setMinter</span><span style="color:#E1E4E8;">(accounts[</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">], </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">  .</span><span style="color:#B392F0;">send</span><span style="color:#E1E4E8;">({ from: accounts[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">] }); </span><span style="color:#6A737D;">// 指定发送交易的地址</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Transaction receipt: \${</span><span style="color:#E1E4E8;">receipt</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">transactionHash</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span></code></pre></div><h3 id="openzeppelin-合约库" tabindex="-1">OpenZeppelin 合约库 <a class="header-anchor" href="#openzeppelin-合约库" aria-label="Permalink to &quot;OpenZeppelin 合约库&quot;">​</a></h3><p>OpenZeppelin 是一个广泛使用的、开源的智能合约库，专门为以太坊等 EVM 兼容链提供安全、可复用的合约组件。它是构建去中心化应用 (DApp) 和协议时的“黄金标准”。</p><p><strong>在 Solidity 智能合约中使用 OpenZeppelin</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 这是一个 Solidity 合约示例，而非 JavaScript</span></span>
<span class="line"><span style="color:#6A737D;">// SPDX-License-Identifier: MIT</span></span>
<span class="line"><span style="color:#E1E4E8;">pragma solidity </span><span style="color:#F97583;">^</span><span style="color:#79B8FF;">0.8</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 导入 OpenZeppelin 的 ERC-20 合约</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#9ECBFF;"> &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">contract MyToken is </span><span style="color:#79B8FF;">ERC20</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#6A737D;">    // 调用 ERC20 父合约的构造函数</span></span>
<span class="line"><span style="color:#B392F0;">    constructor</span><span style="color:#E1E4E8;">() </span><span style="color:#B392F0;">ERC20</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;MyToken&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;MTK&quot;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#6A737D;">        // 向部署者地址铸造 1000 个代币</span></span>
<span class="line"><span style="color:#B392F0;">        _mint</span><span style="color:#E1E4E8;">(msg.sender, </span><span style="color:#79B8FF;">1000</span><span style="color:#F97583;"> *</span><span style="color:#79B8FF;"> 10</span><span style="color:#F97583;"> **</span><span style="color:#B392F0;"> decimals</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></div><p><strong>在前端使用 OpenZeppelin 合约的 ABI</strong> 如果你的合约继承了 OpenZeppelin 的合约，你可以在前端像与任何其他合约一样与之交互。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Contract, BrowserProvider } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;ethers&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#6A737D;">// 导入你编译后的合约 ABI 文件</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> MyTokenAbi </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./artifacts/contracts/MyToken.sol/MyToken.json&#39;</span><span style="color:#F97583;"> assert</span><span style="color:#E1E4E8;"> { type: </span><span style="color:#9ECBFF;">&#39;json&#39;</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> provider</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> BrowserProvider</span><span style="color:#E1E4E8;">(window.ethereum);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> signer</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> provider.</span><span style="color:#B392F0;">getSigner</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 你的合约地址</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> myTokenAddress</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &quot;0x...&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#6A737D;">// 创建合约实例</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> myTokenContract</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Contract</span><span style="color:#E1E4E8;">(myTokenAddress, MyTokenAbi.abi, signer);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 现在可以调用你的 MyToken 合约中的函数了，例如 balanceOf</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> userBalance</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> myTokenContract.</span><span style="color:#B392F0;">balanceOf</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> signer.</span><span style="color:#B392F0;">getAddress</span><span style="color:#E1E4E8;">());</span></span></code></pre></div>`,50)])])}const d=n(o,[["render",e]]);export{F as __pageData,d as default};
